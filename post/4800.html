<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content=#222 media="(prefers-color-scheme: light)"><meta name=theme-color content=#222 media="(prefers-color-scheme: dark)"><meta name=generator content="Hexo 7.3.0"><link rel=preconnect href=https://cdnjs.cloudflare.com crossorigin><link rel=apple-touch-icon sizes=180x180 href=https://cdn.yuuu.org/img/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://cdn.yuuu.org/img/favicon-192x192.png><link rel=icon type=image/png sizes=16x16 href=https://cdn.yuuu.org/img/favicon-32x32.png><link rel=mask-icon href=/images/logo.svg color=#222><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/black/pace-theme-minimal.css><script src=https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin=anonymous></script><script class=next-config data-name=main type=application/json>{"hostname":"yuuu.org","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.21.1","exturl":true,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12,"width":270},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"algolia":{"appID":"8TVS4A6TL8","apiKey":"95c1ff21ae4344bc69e9710b99d7d617","indexName":"blog","hits":{"per_page":10}}}</script><script src=/js/config.js></script><meta name=description content="在 Web 前端开发工作中有很多“重复工作”，比如压缩CSS&#x2F;JS文件。而这些工作都是有规律的。找到这些规律，并编写 gulp 配置代码,让 gulp 自动执行这些“重复工作”。-- form gulp-book"><meta property=og:type content=article><meta property=og:title content="9. 使用 gulp 对资源进行压缩"><meta property=og:url content=https://yuuu.org/post/4800.html><meta property=og:site_name content=微霞><meta property=og:description content="在 Web 前端开发工作中有很多“重复工作”，比如压缩CSS&#x2F;JS文件。而这些工作都是有规律的。找到这些规律，并编写 gulp 配置代码,让 gulp 自动执行这些“重复工作”。-- form gulp-book"><meta property=og:locale content=zh_CN><meta property=og:image content=https://cdn.yuuu.org/post-img/9/1.webp><meta property=og:image content=https://cdn.yuuu.org/post-img/9/2.webp><meta property=og:image content=https://cdn.yuuu.org/post-img/9/3.webp><meta property=article:published_time content=2023-08-24T01:07:42.000Z><meta property=article:modified_time content=2024-10-25T01:07:42.000Z><meta property=article:author content=水氵冫><meta property=article:tag content=折腾><meta name=twitter:card content=summary><meta name=twitter:image content=https://cdn.yuuu.org/post-img/9/1.webp><link rel=canonical href=https://yuuu.org/post/4800.html><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://yuuu.org/post/4800.html","path":"post/4800.html","title":"9. 使用 gulp 对资源进行压缩"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>9. 使用 gulp 对资源进行压缩 | 微霞</title><link rel=stylesheet href=https://cdn.yuuu.org/font/LXGW/result.css><script async src=https://umami.yuuu.org/script.js data-website-id=ac8efb9c-b964-450e-a0a8-d2ee9dc38911 data-cache=true></script><script type=application/ld+json>{
      "@context" : "https://yuuu.org",
      "@type" : "WebSite",
      "name" : "微霞",
      "alternateName" : "微霞",
      "url" : "https://yuuu.org"
    }</script><style>.tk-expand-wrap .tk-expand{width:80%}</style><noscript><link rel=stylesheet href=/css/noscript.css></noscript><link rel=alternate href=/atom.xml title=微霞 type=application/atom+xml><link rel=alternate href=/rss2.xml title=微霞 type=application/rss+xml></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><p class=site-title>微霞</p><i class=logo-line></i></a><p class=site-subtitle itemprop=description>水风清，晚霞明</p></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-rss"><a href=/atom.xml rel=section><i class="fa fa-rss fa-fw"></i>RSS</a></li><li class="menu-item menu-item-友链"><a href=/links rel=section><i class="fa fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-番剧"><a href=/bangumis/index.html rel=section><i class="fa fa-play-circle fa-fw"></i>番剧</a></li><li class="menu-item menu-item-追剧"><a href=/cinemas/index.html rel=section><i class="fas fa-video fa-fw"></i>追剧</a></li><li class="menu-item menu-item-书籍"><a href=/books/index.html rel=section><i class="fas fa-book fa-fw"></i>书籍</a></li><li class="menu-item menu-item-search"><a role=button class=popup-trigger><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class=search-result-container><div class=search-result-icon><i class="fab fa-algolia fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%BB%80%E4%B9%88%E6%98%AFgulp><span class=nav-number>1.</span> <span class=nav-text>什么是 gulp</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%AE%89%E8%A3%85gulp><span class=nav-number>2.</span> <span class=nav-text>安装 gulp</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6><span class=nav-number>3.</span> <span class=nav-text>安装插件</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%BD%BF%E7%94%A8><span class=nav-number>4.</span> <span class=nav-text>使用</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%BF%90%E8%A1%8C%E5%92%8C%E5%B0%8F%E5%B0%8F%E7%9A%84%E6%94%B9%E8%BF%9B><span class=nav-number>5.</span> <span class=nav-text>运行和小小的改进</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9><span class=nav-number>6.</span> <span class=nav-text>注意事项</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0><span class=nav-number>7.</span> <span class=nav-text>参考文章</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=水氵冫 src=https://cdn.yuuu.org/img/avatar.avif><p class=site-author-name itemprop=name>水氵冫</p><div class=site-description itemprop=description>这是一个分享技术、生活和思考的个人博客，记录成长的点滴.</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>21</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang=zh-CN><link itemprop=mainEntityOfPage href=https://yuuu.org/post/4800.html><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=https://cdn.yuuu.org/img/avatar.avif><meta itemprop=name content=水氵冫></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=微霞><meta itemprop=description content=这是一个分享技术、生活和思考的个人博客，记录成长的点滴.></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="9. 使用 gulp 对资源进行压缩 | 微霞"><meta itemprop=description content="在 Web 前端开发工作中有很多“重复工作”，比如压缩CSS/JS文件。而这些工作都是有规律的。找到这些规律，并编写 gulp 配置代码,让 gulp 自动执行这些“重复工作”。-- form gulp-book"></span><header class=post-header><h1 class=post-title itemprop="name headline">9. 使用 gulp 对资源进行压缩</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span> <span class=post-meta-item-text>发表于</span> <time title="创建时间：2023-08-24 09:07:42" itemprop="dateCreated datePublished" datetime=2023-08-24T09:07:42+08:00>2023-08-24</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar-check"></i></span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2024-10-25 09:07:42" itemprop=dateModified datetime=2024-10-25T09:07:42+08:00>2024-10-25</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder"></i></span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E6%8A%98%E8%85%BE/ itemprop=url rel=index><span itemprop=name>折腾</span></a></span></span><span class=post-meta-break></span><span class=post-meta-item title=本文字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span> <span class=post-meta-item-text>本文字数：</span> <span>2k</span></span><span class=post-meta-item title=阅读时长><span class=post-meta-item-icon><i class="far fa-clock"></i></span> <span class=post-meta-item-text>阅读时长 &asymp;</span> <span>7 分钟</span></span></div><div class=post-description>在 Web 前端开发工作中有很多“重复工作”，比如压缩CSS/JS文件。而这些工作都是有规律的。找到这些规律，并编写 gulp 配置代码,让 gulp 自动执行这些“重复工作”。-- form gulp-book</div></div></header><div class=post-body itemprop=articleBody><p><strong>2024/10/25：gulp 已经更新了 5.0，我所使用的配置文件中所用的 gulp-fontmin 是过时的插件，除非安装 gulp4，不然以下配置文件可能会出现不可预料的错误。</strong></p><p>在 Web 前端开发工作中有很多 “重复工作”，比如压缩 CSS/JS 文件。而这些工作都是有规律的。找到这些规律，并编写 gulp 配置代码，让 gulp 自动执行这些 “重复工作”。-- form gulp-book!</p><h2 id=什么是gulp>什么是 gulp</h2><p>Gulp 是一个流行的自动化构建工具，用于简化这些重复性的任务。Gulp 的核心思想是利用代码来自动化处理开发过程中的繁琐任务，从而提高开发效率和代码质量。正如官网上所说:<br>“A toolkit to automate &amp; enhance your workflow”<br>“Leverage gulp and the flexibility of JavaScript to automate slow, repetitive workflows and compose them into efficient build pipelines.”</p><p>而 Gulp 的强大之处在于它的插件生态系统。插件是用于处理特定任务的 JavaScript 模块。我们可以安装部分插件来使我们完成对博客静态资源的压缩。</p><h2 id=安装gulp>安装 gulp</h2><p>gulp 是基于 node.js 开发的，我们需要先安装 node.js 和 npm，npm 会在安装完 node.js 后自动安装。安装完成后看看是否安装成功。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line><span class=comment># 检查安装</span></span><br><span class=line>node -v</span><br><span class=line>npm -v</span><br></pre></td></tr></tbody></table></figure><p>我使用 hexo 来建站，hexo 本身需要依托 node.js，所以使用 hexo 的朋友可以跳过安装 node.js 这一步。</p><p>安装 Gulp 的命令行工具，这样可以使我们在命令行中使用 gulp。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>npm install -g gulp-cli</span><br><span class=line><span class=comment># 检查版本</span></span><br><span class=line>gulp -v</span><br></pre></td></tr></tbody></table></figure><h2 id=安装插件>安装插件</h2><p>gulp 拥有着丰富的插件支持，其中就有我们所需要的压缩网页的插件。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre></td><td class=code><pre><span class=line><span class=comment># 安装 gulp </span></span><br><span class=line>npm install gulp --save-dev</span><br><span class=line><span class=comment># 删除无用文件</span></span><br><span class=line>npm install gulp-clean --save-dev</span><br><span class=line><span class=comment># 压缩和优化 CSS </span></span><br><span class=line>npm install gulp-clean-css --save-dev</span><br><span class=line><span class=comment># 压缩字体文件</span></span><br><span class=line>npm install gulp-fontmin --save-dev</span><br><span class=line><span class=comment># 压缩和优化 HTML 文件</span></span><br><span class=line>npm install gulp-html-minifier-terser --save-dev</span><br><span class=line><span class=comment># 清理和格式化 HTML 文件</span></span><br><span class=line>npm install gulp-htmlclean --save-dev</span><br><span class=line><span class=comment># 压缩和混淆 JavaScript 文件</span></span><br><span class=line>npm install gulp-terser --save-dev</span><br><span class=line><span class=comment># 用于将 TrueType 字体文件 (.ttf) 转换为 WOFF2 格式</span></span><br><span class=line>npm install gulp-ttf2woff2 --save-dev</span><br></pre></td></tr></tbody></table></figure><h2 id=使用>使用</h2><p>安装完成后，在博客根目录新建 <code>gulpfile.js</code>，并且输入以下内容</p><figure class="highlight javascript"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br></pre></td><td class=code><pre><span class=line><span class=comment>// 引入所需的插件</span></span><br><span class=line><span class=keyword>const</span> gulp = <span class=built_in>require</span>(<span class=string>'gulp'</span>);</span><br><span class=line><span class=keyword>const</span> htmlmin = <span class=built_in>require</span>(<span class=string>'gulp-html-minifier-terser'</span>);</span><br><span class=line><span class=keyword>const</span> htmlclean = <span class=built_in>require</span>(<span class=string>'gulp-htmlclean'</span>);</span><br><span class=line><span class=keyword>const</span> cleanCSS = <span class=built_in>require</span>(<span class=string>'gulp-clean-css'</span>);</span><br><span class=line><span class=keyword>const</span> terser = <span class=built_in>require</span>(<span class=string>'gulp-terser'</span>);</span><br><span class=line><span class=keyword>const</span> fontmin = <span class=built_in>require</span>(<span class=string>'gulp-fontmin'</span>);</span><br><span class=line><span class=keyword>const</span> ttf2woff2 = <span class=built_in>require</span>(<span class=string>'gulp-ttf2woff2'</span>);</span><br><span class=line><span class=keyword>const</span> clean = <span class=built_in>require</span>(<span class=string>'gulp-clean'</span>);</span><br><span class=line></span><br><span class=line><span class=comment>// 压缩和清理 HTML</span></span><br><span class=line>gulp.<span class="title function_">task</span>(<span class=string>'minify-html'</span>, <span class=function>() =&gt;</span> {</span><br><span class=line>  <span class=keyword>return</span> gulp.<span class="title function_">src</span>(<span class=string>'./public/**/*.html'</span>)<span class=comment>// 看情况修改</span></span><br><span class=line>    .<span class="title function_">pipe</span>(<span class="title function_">htmlclean</span>())</span><br><span class=line>    .<span class="title function_">pipe</span>(<span class="title function_">htmlmin</span>({ </span><br><span class=line>      <span class=attr>collapseWhitespace</span>: <span class=literal>true</span> ,</span><br><span class=line>      <span class=attr>removeComments</span>: <span class=literal>true</span>, <span class=comment>//清除html注释</span></span><br><span class=line>      <span class=attr>collapseWhitespace</span>: <span class=literal>true</span>, <span class=comment>//折叠文档树中构成文本节点的空白区域</span></span><br><span class=line>      <span class=attr>collapseBooleanAttributes</span>: <span class=literal>true</span>,</span><br><span class=line>      <span class=comment>//省略布尔属性的值，例如：&lt;input checked="true"/&gt; ==&gt; &lt;input /&gt;</span></span><br><span class=line>      <span class=attr>removeEmptyAttributes</span>: <span class=literal>true</span>,</span><br><span class=line>      <span class=comment>//删除所有空格作属性值，例如：&lt;input id="" /&gt; ==&gt; &lt;input /&gt;</span></span><br><span class=line>      <span class=attr>removeScriptTypeAttributes</span>: <span class=literal>true</span>,</span><br><span class=line>      <span class=comment>//删除&lt;script&gt;的type="text/javascript"</span></span><br><span class=line>      <span class=attr>removeStyleLinkTypeAttributes</span>: <span class=literal>true</span>,</span><br><span class=line>      <span class=comment>//删除&lt;style&gt;和&lt;link&gt;的 type="text/css"</span></span><br><span class=line>      <span class=attr>removeAttributeQuotes</span>: <span class=literal>true</span>, <span class=comment>// 移除属性值周围的引号</span></span><br><span class=line>      <span class=attr>removeCDATASectionsFromCDATA</span>: <span class=literal>true</span>, <span class=comment>// 从 CDATA 部分移除注释</span></span><br><span class=line>      <span class=attr>caseSensitive</span>: <span class=literal>true</span>,        <span class=comment>// 以区分大小写的方式处理属性</span></span><br><span class=line>      <span class=attr>minifyJS</span>: <span class=literal>true</span>, <span class=comment>//压缩页面 JS</span></span><br><span class=line>      <span class=attr>minifyCSS</span>: <span class=literal>true</span>, <span class=comment>//压缩页面 CSS</span></span><br><span class=line>      <span class=attr>minifyURLs</span>: <span class=literal>true</span> , <span class=comment>//压缩页面URL</span></span><br><span class=line>    }))</span><br><span class=line>    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class=string>'./public'</span>))<span class=comment>// 看情况修改</span></span><br><span class=line>});</span><br><span class=line></span><br><span class=line><span class=comment>// 压缩 CSS</span></span><br><span class=line>gulp.<span class="title function_">task</span>(<span class=string>'minify-css'</span>, <span class=function>() =&gt;</span> {</span><br><span class=line>  <span class=keyword>return</span> gulp.<span class="title function_">src</span>([<span class=string>'./public/**/*.css'</span>])<span class=comment>// 看情况修改</span></span><br><span class=line>  .<span class="title function_">pipe</span>(<span class="title function_">cleanCSS</span>({</span><br><span class=line>    <span class=attr>level</span>: {</span><br><span class=line>      <span class=number>2</span>: {</span><br><span class=line>        <span class=attr>mergeAdjacentRules</span>: <span class=literal>true</span>, </span><br><span class=line>        <span class=comment>// 控制相邻规则的合并，默认为 true</span></span><br><span class=line>        <span class=attr>mergeIntoShorthands</span>: <span class=literal>true</span>, </span><br><span class=line>        <span class=comment>// 控制属性合并为简写形式，默认为 true</span></span><br><span class=line>        <span class=attr>mergeMedia</span>: <span class=literal>true</span>, </span><br><span class=line>        <span class=comment>// 控制 @media 规则的合并，默认为 true</span></span><br><span class=line>        <span class=attr>mergeNonAdjacentRules</span>: <span class=literal>true</span>, </span><br><span class=line>        <span class=comment>// 控制非相邻规则的合并，默认为 true</span></span><br><span class=line>        <span class=attr>mergeSemantically</span>: <span class=literal>false</span>,</span><br><span class=line>         <span class=comment>// 控制语义合并，默认为 false</span></span><br><span class=line>        <span class=attr>overrideProperties</span>: <span class=literal>true</span>, </span><br><span class=line>        <span class=comment>// 基于可读性控制属性覆盖，默认为 true</span></span><br><span class=line>        <span class=attr>removeEmpty</span>: <span class=literal>true</span>, </span><br><span class=line>        <span class=comment>// 控制删除空规则和嵌套块，默认为 true</span></span><br><span class=line>        <span class=attr>reduceNonAdjacentRules</span>: <span class=literal>true</span>, </span><br><span class=line>        <span class=comment>// 控制非相邻规则的缩减，默认为 true</span></span><br><span class=line>        <span class=attr>removeDuplicateFontRules</span>: <span class=literal>true</span>,</span><br><span class=line>         <span class=comment>// 控制删除重复的 @font-face 规则，默认为 true</span></span><br><span class=line>        <span class=attr>removeDuplicateMediaBlocks</span>: <span class=literal>true</span>, </span><br><span class=line>        <span class=comment>// 控制删除重复的 @media 规则，默认为 true</span></span><br><span class=line>        <span class=attr>removeDuplicateRules</span>: <span class=literal>true</span>, </span><br><span class=line>        <span class=comment>// 控制删除重复的规则，默认为 true</span></span><br><span class=line>        <span class=attr>removeUnusedAtRules</span>: <span class=literal>false</span>, </span><br><span class=line>        <span class=comment>// 控制删除未使用的 at 规则，默认为 false（自版本 4.1.0 起可用）</span></span><br><span class=line>        <span class=attr>restructureRules</span>: <span class=literal>false</span>, </span><br><span class=line>        <span class=comment>// 控制规则重构，默认为 false</span></span><br><span class=line>        <span class=attr>skipProperties</span>: [] </span><br><span class=line>        <span class=comment>// 控制不进行优化的属性，默认为 []，即所有属性都进行优化（自版本 4.1.0 起可用）</span></span><br><span class=line>      }</span><br><span class=line>    }</span><br><span class=line>  }))</span><br><span class=line>    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class=string>'./public'</span>));<span class=comment>// 看情况修改</span></span><br><span class=line>});</span><br><span class=line></span><br><span class=line><span class=comment>// 压缩 JavaScript</span></span><br><span class=line>gulp.<span class="title function_">task</span>(<span class=string>'compress'</span>, <span class="title function_">async</span>() =&gt;{</span><br><span class=line>  <span class=keyword>return</span> gulp.<span class="title function_">src</span>([<span class=string>'./public/**/*.js'</span>, <span class=string>'!./public/**/*.min.js'</span>])<span class=comment>// 看情况修改</span></span><br><span class=line>    .<span class="title function_">pipe</span>(<span class="title function_">terser</span>())</span><br><span class=line>    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class=string>'./public'</span>));<span class=comment>// 看情况修改</span></span><br><span class=line>});</span><br><span class=line></span><br><span class=line><span class=comment>//读取文章使用字体，然后压缩</span></span><br><span class=line>gulp.<span class="title function_">task</span>(<span class=string>'mini-font'</span>, <span class=function>(<span class=params>cb</span>) =&gt;</span> {</span><br><span class=line>  <span class=keyword>var</span> buffers = [];</span><br><span class=line>  gulp</span><br><span class=line>    .<span class="title function_">src</span>([<span class=string>'./public/**/*.html'</span>]) <span class=comment>// 看情况修改</span></span><br><span class=line>    .<span class="title function_">on</span>(<span class=string>'data'</span>, <span class=keyword>function</span>(<span class=params>file</span>) {</span><br><span class=line>      buffers.<span class="title function_">push</span>(file.<span class=property>contents</span>);</span><br><span class=line>    })</span><br><span class=line>    .<span class="title function_">on</span>(<span class=string>'end'</span>, <span class=keyword>function</span>(<span class=params></span>) {</span><br><span class=line>      <span class=keyword>var</span> text = <span class="title class_">Buffer</span>.<span class="title function_">concat</span>(buffers).<span class="title function_">toString</span>(<span class=string>'utf-8'</span>);</span><br><span class=line>      <span class="title function_">minifyFont</span>(text, cb);</span><br><span class=line>    });</span><br><span class=line>});</span><br><span class=line></span><br><span class=line><span class=comment>//压缩字体</span></span><br><span class=line><span class=keyword>function</span> <span class="title function_">minifyFont</span>(<span class=params>text, cb</span>) {</span><br><span class=line>  gulp</span><br><span class=line>    .<span class="title function_">src</span>(<span class=string>'./public/font/*.ttf'</span>) <span class=comment>//原字体所在目录</span></span><br><span class=line>    .<span class="title function_">pipe</span>(<span class="title function_">fontmin</span>({</span><br><span class=line>      <span class=attr>text</span>: text</span><br><span class=line>    }))</span><br><span class=line>    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class=string>'./public/fonts/'</span>)) <span class=comment>//压缩后的输出目录</span></span><br><span class=line>    .<span class="title function_">on</span>(<span class=string>'end'</span>, cb);</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 定义转换 TTF 到 WOFF2 的任务</span></span><br><span class=line>gulp.<span class="title function_">task</span>(<span class=string>'convertFonts'</span>, <span class=keyword>function</span>(<span class=params></span>) {</span><br><span class=line>  <span class=keyword>return</span> gulp.<span class="title function_">src</span>(<span class=string>'./public/fonts/*.ttf'</span>)<span class=comment>// 看情况修改</span></span><br><span class=line>    .<span class="title function_">pipe</span>(<span class="title function_">ttf2woff2</span>())</span><br><span class=line>    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class=string>'./public/fonts/'</span>));<span class=comment>// 看情况修改</span></span><br><span class=line>});</span><br><span class=line></span><br><span class=line><span class=comment>//删除字体原文件，主题生成的图片文件</span></span><br><span class=line>gulp.<span class="title function_">task</span>(<span class=string>'clean-files'</span>, <span class=keyword>function</span>(<span class=params></span>) {</span><br><span class=line>  <span class=keyword>return</span> gulp.<span class="title function_">src</span>([<span class=string>'./public/font'</span>,<span class=string>'./public/images'</span>], { <span class=attr>read</span>: <span class=literal>false</span>, <span class=attr>allowEmpty</span>: <span class=literal>true</span> })<span class=comment>// 看情况修改</span></span><br><span class=line>    .<span class="title function_">pipe</span>(<span class="title function_">clean</span>());</span><br><span class=line>});</span><br><span class=line></span><br><span class=line><span class=comment>// 运行gulp命令时依次执行以下任务</span></span><br><span class=line>gulp.<span class="title function_">task</span>(<span class=string>'default'</span>, gulp.<span class="title function_">series</span>(</span><br><span class=line>  gulp.<span class="title function_">parallel</span>(<span class=string>'compress'</span>, <span class=string>'minify-css'</span>, <span class=string>'minify-html'</span>, <span class=string>'mini-font'</span>,), </span><br><span class=line>  <span class=string>'convertFonts'</span>,<span class=comment>// 在 'mini-font' 完成后执行 'convertFonts'，最后执行clean-files</span></span><br><span class=line>  <span class=string>'clean-files'</span> </span><br><span class=line>))</span><br></pre></td></tr></tbody></table></figure><h2 id=运行和小小的改进>运行和小小的改进</h2><p>重新渲染一次，并执行 gulp，接下来就可以看到 gulp 压缩后的效果了。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line>hexo cl</span><br><span class=line>hexo g</span><br><span class=line>gulp</span><br><span class=line>hexo s</span><br></pre></td></tr></tbody></table></figure><p>上图为 gulp 执行前后的文件大小对比图，其中 public 为未执行 gulp 指令，public-gulp 为执行 gulp 指令。下图两者均去除字体文件和 images 文件夹后只对比 html,css,js 的大小。<br><img data-src=https://cdn.yuuu.org/post-img/9/1.webp alt="" loading=lazy><br><img data-src=https://cdn.yuuu.org/post-img/9/2.webp alt="" loading=lazy></p><p>可以看出，在去除字体文件和 images 文件夹后，其他的文件压缩了大约 100kb 的大小 o_o …。但是在网站中占大头的字体文件却是狠狠的压缩了，总算是不用担心网站打开速度被字体拖慢了。尽管从上图看，字体的压缩看似是从 15MB 降低至了 8MB，但其实在 <code>tff2woff2</code> 所转化的字体文件夹中，会同时将 tff 转化为 .eot , .woff2 , .woff , .ttf , .svg 多个字体格式，从而做到各个网站的适配。而目前主流浏览器大多使用 woff2 格式，也就是说，我们打开网页的时候，大概率是使用 woff2 字体，如果不去适配 IE 和低版本浏览器，大概也可以再将字体文件删除。下边的代码块是只保留 woff2 字体删除其他字体的。<s>虽然没什么用，毕竟浏览器是按照样式表来下载字体的，多余的字体文件不会被下载，留在这里也没什么影响。</s>。</p><figure class="highlight js"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre></td><td class=code><pre><span class=line></span><br><span class=line>gulp.<span class="title function_">task</span>(<span class=string>'clean-files'</span>, <span class=keyword>function</span>(<span class=params></span>) {</span><br><span class=line>  <span class=keyword>return</span> gulp.<span class="title function_">src</span>([</span><br><span class=line>    <span class=string>'./public/font'</span>,</span><br><span class=line>    <span class=string>'./public/images'</span>,</span><br><span class=line>    <span class=string>'./public/fonts/yourfont.eot'</span>,</span><br><span class=line>    <span class=string>'./public/fonts/yourfont.ttf'</span>,</span><br><span class=line>    <span class=string>'./public/fonts/yourfont.svg'</span>,</span><br><span class=line>    <span class=string>'./public/fonts/yourfont.woff'</span>,<span class=comment>// 看情况修改字体名字</span></span><br><span class=line>    ], { <span class=attr>read</span>: <span class=literal>false</span>, <span class=attr>allowEmpty</span>: <span class=literal>true</span> })</span><br><span class=line>    .<span class="title function_">pipe</span>(<span class="title function_">clean</span>());</span><br><span class=line>});</span><br></pre></td></tr></tbody></table></figure><p>附上一张不使用任何处理，只是用 ttf2woff2 处理字体后，输出文件夹字体占用大小截图，可以看到，svg 居然占到了丧心病狂的 4M，而 woff2 只有 699kb，<s>删了会清爽很多</s>。</p><p><img data-src=https://cdn.yuuu.org/post-img/9/3.webp alt="" loading=lazy></p><h2 id=注意事项>注意事项</h2><p><code>ttf2woff2</code> 会在指定目录生成一个文件夹，其中会有’字体文件名字.css’的 css 文件，将它引入即可使用转化后的字体文件。</p><p>使用 gulp 压缩字体必须在本地进行，进一步导致本地文件增大，看着有点难受。我有在想，是否可以做到当博客仓库提交的时候自动触发 action，拉取字体文件进行处理，然后博客再通过网络引入该 css，从而做到 public 文件夹的干净。但是最后实在是不想折腾，也就放弃了。</p><p>我所使用的图片均由外链引入，不需要 hexo 的 images 文件夹，所以使用 clean-files 时顺便将其删除。如需使用 images，请自行修改。当然，gulp 也有与压缩图片有关的插件，可自行搜索使用。</p><p>更详细的设置请参考所用插件的官方文档。</p><h2 id=参考文章>参考文章</h2><p><span class=exturl data-url="aHR0cHM6Ly9naXRodWIuY29tL25pbW9jL2d1bHAtYm9vaw==">gulp-book<i class="fa fa-external-link-alt"></i></span><br><span class=exturl data-url="aHR0cHM6Ly9ha2lsYXIudG9wL3Bvc3RzLzQ5YjczYjg3Lw==">使用 gulp 压缩博客静态资源<i class="fa fa-external-link-alt"></i></span></p></div><footer class=post-footer><div class=post-copyright><ul><li class=post-copyright-author><strong>本文作者：</strong> 水氵冫</li><li class=post-copyright-link><strong>本文链接：</strong> <a href=https://yuuu.org/post/4800.html title="9. 使用 gulp 对资源进行压缩">https://yuuu.org/post/4800.html</a></li><li class=post-copyright-license><strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<span class=exturl data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div><div class=post-tags><a href=/tags/%E6%8A%98%E8%85%BE/ rel=tag><i class="fa fa-tag"></i> 折腾</a></div><div class=post-nav><div class=post-nav-item><a href=/post/47.html rel=prev title="8. 购入产品记录"><i class="fa fa-angle-left"></i> 8. 购入产品记录</a></div><div class=post-nav-item><a href=/post/37582.html rel=next title="10. 购入一台笔记本">10. 购入一台笔记本<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class=comments><div id=twikoo-comments></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; 2023 – <span itemprop=copyrightYear>2025</span><span class=with-love><i class="fa fa-heart"></i></span> <span class=author itemprop=copyrightHolder>水氵冫</span></div><div class=wordcount><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-chart-line"></i></span> <span>站点总字数：</span> <span title=站点总字数>36k</span></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-coffee"></i></span> <span>站点阅读时长 &asymp;</span> <span title=站点阅读时长>2:12</span></span></div><a style=color:#999;border-bottom:none!important ; href="https://icp.gov.moe/?keyword=20242424" target=_blank>萌ICP备20242424号</a></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div class=back-to-top role=button aria-label=返回顶部><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin=anonymous></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script src=/js/bookmark.js></script><script src=/js/pjax.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.24.0/algoliasearch-lite.umd.js integrity="sha256-b2n6oSgG4C1stMT/yc/ChGszs9EY/Mhs6oltEjQbFCQ=" crossorigin=anonymous></script><script src=/js/third-party/search/algolia-search.js></script><script src=/js/third-party/pace.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin=anonymous></script><script class=next-config data-name=quicklink type=application/json>{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://yuuu.org/post/4800.html"}</script><script src=/js/third-party/quicklink.js></script><script class=next-config data-name=twikoo type=application/json>{"enable":true,"visitor":false,"envId":"https://twikoo.yuuu.org","el":"#twikoo-comments"}</script><script>document.addEventListener("page:loaded",(()=>{NexT.utils.loadComments(CONFIG.twikoo.el).then((()=>NexT.utils.getScript(CONFIG.twikoo.jsUrl||"https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js",{condition:window.twikoo}))).then((()=>{twikoo.init(CONFIG.twikoo)}))}))</script><style>.comments,.post-block{overflow:visible}.tk-owo-emotion{display:inline-block}</style><script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.2/anime.min.js></script><script>var canvasEl=document.createElement("canvas");canvasEl.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:9999999",document.body.appendChild(canvasEl);var ctx=canvasEl.getContext("2d"),numberOfParticules=30,pointerX=0,pointerY=0,tap="click",colors=["rgba(255,182,185,.9)","rgba(250,227,217,.9)","rgba(187,222,214,.9)","rgba(138,198,209,.9)"];function setCanvasSize(){canvasEl.width=2*window.innerWidth,canvasEl.height=2*window.innerHeight,canvasEl.style.width=window.innerWidth+"px",canvasEl.style.height=window.innerHeight+"px",canvasEl.getContext("2d").scale(2,2)}function updateCoords(e){pointerX=e.clientX||e.touches&&e.touches[0].clientX,pointerY=e.clientY||e.touches&&e.touches[0].clientY}function setParticuleDirection(e){var a=anime.random(0,360)*Math.PI/180,t=anime.random(50,180),n=[-1,1][anime.random(0,1)]*t;return{x:e.x+n*Math.cos(a),y:e.y+n*Math.sin(a)}}function createParticule(e,a){var t={};return t.x=e,t.y=a,t.color=colors[anime.random(0,colors.length-1)],t.radius=anime.random(16,32),t.endPos=setParticuleDirection(t),t.draw=function(){ctx.beginPath(),ctx.arc(t.x,t.y,t.radius,0,2*Math.PI,!0),ctx.fillStyle=t.color,ctx.fill()},t}function createCircle(e,a){var t={};return t.x=e,t.y=a,t.color="#FFF",t.radius=.1,t.alpha=.5,t.lineWidth=6,t.draw=function(){ctx.globalAlpha=t.alpha,ctx.beginPath(),ctx.arc(t.x,t.y,t.radius,0,2*Math.PI,!0),ctx.lineWidth=t.lineWidth,ctx.strokeStyle=t.color,ctx.stroke(),ctx.globalAlpha=1},t}function renderParticule(e){for(var a=0;a<e.animatables.length;a++)e.animatables[a].target.draw()}function animateParticules(e,a){for(var t=createCircle(e,a),n=[],i=0;i<numberOfParticules;i++)n.push(createParticule(e,a));anime.timeline().add({targets:n,x:function(e){return e.endPos.x},y:function(e){return e.endPos.y},radius:.1,duration:anime.random(1200,1800),easing:"easeOutExpo",update:renderParticule}).add({targets:t,radius:anime.random(80,160),lineWidth:0,alpha:{value:0,easing:"linear",duration:anime.random(600,800)},duration:anime.random(1200,1800),easing:"easeOutExpo",update:renderParticule},0)}var render=anime({duration:1/0,update:function(){ctx.clearRect(0,0,canvasEl.width,canvasEl.height)}});document.addEventListener(tap,(function(e){render.play(),updateCoords(e),animateParticules(pointerX,pointerY)}),!1),setCanvasSize(),window.addEventListener("resize",setCanvasSize,!1)</script><script>document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector("body"),t=document.getElementById("g-pointer-1"),n=document.getElementById("g-pointer-2");let o;if(!t||!n)return void console.error("元素未找到");const i=t.offsetWidth/2,s=n.offsetWidth/2;e.addEventListener("mousemove",(function(e){t.classList.add("pointer-visible"),n.classList.add("pointer-visible"),window.requestAnimationFrame((()=>{var o,r;o=e.clientX,r=e.clientY,t.style.transform=`translate(${o-i}px, ${r-i}px)`,n.style.transform=`translate(${o-s}px, ${r-s}px)`})),clearTimeout(o),o=setTimeout((()=>{t.classList.remove("pointer-visible"),n.classList.remove("pointer-visible")}),1e3)}))}))</script><div id=g-pointer-1></div><div id=g-pointer-2></div><canvas id=map></canvas><script src=https://cdn.jsdelivr.net/gh/lrsjng/pagemap/dist/pagemap.min.js></script><script>pagemap(document.querySelector("#map"),{viewport:null,styles:{"header,footer,section,article":"rgba(0,0,0,0.08)","h1,a":"rgba(0,0,0,0.10)","h2,h3,h4":"rgba(0,0,0,0.08)"},back:"rgba(0,0,0,0.02)",view:"rgba(0,0,0,0.05)",drag:"rgba(0,0,0,0.10)",interval:null})</script><script>document.addEventListener("DOMContentLoaded",(function(){if(/Android|iPhone|iPad|iPod|Windows Phone/i.test(navigator.userAgent)){["g-pointer-1","g-pointer-2"].forEach((e=>{let n=document.getElementById(e);n&&(n.style.display="none")}))}}))</script></body></html>