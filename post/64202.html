<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content=#222 media="(prefers-color-scheme: light)"><meta name=theme-color content=#222 media="(prefers-color-scheme: dark)"><meta name=generator content="Hexo 7.3.0"><link rel=preconnect href=https://cdnjs.cloudflare.com crossorigin><link rel=apple-touch-icon sizes=180x180 href=https://cdn.yuuu.org/img/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://cdn.yuuu.org/img/favicon-192x192.png><link rel=icon type=image/png sizes=16x16 href=https://cdn.yuuu.org/img/favicon-32x32.png><link rel=mask-icon href=/images/logo.svg color=#222><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/black/pace-theme-minimal.css><script src=https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin=anonymous></script><script class=next-config data-name=main type=application/json>{"hostname":"yuuu.org","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.21.1","exturl":true,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12,"width":270},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"algolia":{"appID":"8TVS4A6TL8","apiKey":"95c1ff21ae4344bc69e9710b99d7d617","indexName":"blog","hits":{"per_page":10}}}</script><script src=/js/config.js></script><meta name=description content=这两天都在玩linux，谈谈最近学习的ssh。><meta property=og:type content=article><meta property=og:title content="13.ssh 知识整理"><meta property=og:url content=https://yuuu.org/post/64202.html><meta property=og:site_name content=微霞><meta property=og:description content=这两天都在玩linux，谈谈最近学习的ssh。><meta property=og:locale content=zh_CN><meta property=article:published_time content=2024-02-14T07:22:00.000Z><meta property=article:modified_time content=2024-02-14T07:22:00.000Z><meta property=article:author content=水氵冫><meta property=article:tag content=学习><meta name=twitter:card content=summary><link rel=canonical href=https://yuuu.org/post/64202.html><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://yuuu.org/post/64202.html","path":"post/64202.html","title":"13.ssh 知识整理"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>13.ssh 知识整理 | 微霞</title><link rel=stylesheet href=https://cdn.yuuu.org/font/LXGW/result.css><script async src=https://umami.yuuu.org/script.js data-website-id=ac8efb9c-b964-450e-a0a8-d2ee9dc38911 data-cache=true></script><script type=application/ld+json>{
      "@context" : "https://yuuu.org",
      "@type" : "WebSite",
      "name" : "微霞",
      "alternateName" : "微霞",
      "url" : "https://yuuu.org"
    }</script><style>.tk-expand-wrap .tk-expand{width:80%}</style><noscript><link rel=stylesheet href=/css/noscript.css></noscript><link rel=alternate href=/atom.xml title=微霞 type=application/atom+xml><link rel=alternate href=/rss2.xml title=微霞 type=application/rss+xml></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><p class=site-title>微霞</p><i class=logo-line></i></a><p class=site-subtitle itemprop=description>水风清，晚霞明</p></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-rss"><a href=/atom.xml rel=section><i class="fa fa-rss fa-fw"></i>RSS</a></li><li class="menu-item menu-item-友链"><a href=/links rel=section><i class="fa fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-番剧"><a href=/bangumis/index.html rel=section><i class="fa fa-play-circle fa-fw"></i>番剧</a></li><li class="menu-item menu-item-追剧"><a href=/cinemas/index.html rel=section><i class="fas fa-video fa-fw"></i>追剧</a></li><li class="menu-item menu-item-书籍"><a href=/books/index.html rel=section><i class="fas fa-book fa-fw"></i>书籍</a></li><li class="menu-item menu-item-search"><a role=button class=popup-trigger><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class=search-result-container><div class=search-result-icon><i class="fab fa-algolia fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%9F%BA%E7%A1%80><span class=nav-number>1.</span> <span class=nav-text>基础</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#ssh%E6%97%A0%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95><span class=nav-number>2.</span> <span class=nav-text>ssh 无密码登录</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%9B%B4%E7%AE%80%E4%BE%BF%E4%B8%80%E7%82%B9><span class=nav-number>2.1.</span> <span class=nav-text>更简便一点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#ssh%E5%88%AB%E5%90%8D><span class=nav-number>3.</span> <span class=nav-text>ssh 别名</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#ssh%E5%88%AB%E5%90%8D%E7%9A%84%E5%85%B6%E4%BB%96%E9%80%89%E9%A1%B9><span class=nav-number>3.1.</span> <span class=nav-text>ssh 别名的其他选项</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#ForwardAgent><span class=nav-number>3.1.1.</span> <span class=nav-text>ForwardAgent</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#ServerAliveInterval-%E5%92%8C-ServerAliveCountMax><span class=nav-number>3.1.2.</span> <span class=nav-text>ServerAliveInterval 和 ServerAliveCountMax</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%85%B6%E4%BB%96%E7%9A%84%E6%8C%87%E4%BB%A4><span class=nav-number>4.</span> <span class=nav-text>其他的指令</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%AE%B0%E5%BD%95><span class=nav-number>5.</span> <span class=nav-text>记录</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=水氵冫 src=https://cdn.yuuu.org/img/avatar.avif><p class=site-author-name itemprop=name>水氵冫</p><div class=site-description itemprop=description>这是一个分享技术、生活和思考的个人博客，记录成长的点滴.</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>21</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang=zh-CN><link itemprop=mainEntityOfPage href=https://yuuu.org/post/64202.html><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=https://cdn.yuuu.org/img/avatar.avif><meta itemprop=name content=水氵冫></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=微霞><meta itemprop=description content=这是一个分享技术、生活和思考的个人博客，记录成长的点滴.></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="13.ssh 知识整理 | 微霞"><meta itemprop=description content=这两天都在玩linux，谈谈最近学习的ssh。></span><header class=post-header><h1 class=post-title itemprop="name headline">13.ssh 知识整理</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span> <span class=post-meta-item-text>发表于</span> <time title="创建时间：2024-02-14 15:22:00" itemprop="dateCreated datePublished" datetime=2024-02-14T15:22:00+08:00>2024-02-14</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder"></i></span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AD%A6%E4%B9%A0/ itemprop=url rel=index><span itemprop=name>学习</span></a></span></span><span class=post-meta-break></span><span class=post-meta-item title=本文字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span> <span class=post-meta-item-text>本文字数：</span> <span>4.1k</span></span><span class=post-meta-item title=阅读时长><span class=post-meta-item-icon><i class="far fa-clock"></i></span> <span class=post-meta-item-text>阅读时长 &asymp;</span> <span>15 分钟</span></span></div><div class=post-description>这两天都在玩linux，谈谈最近学习的ssh。</div></div></header><div class=post-body itemprop=articleBody><p>这并不是一篇指导性的文章，而是一篇初学者的笔记，可能会随时改动，其中也可能遍布错误。此外，我感觉这更像是一篇冗长啰嗦的唠叨。😪</p><p>以下代码都是在 Debian 系统上进行的操作。</p><h2 id=基础>基础</h2><p>一般情况下 linux 默认安装了 ssh。linux 一般使用 ssh 连接。没有安装的话可以按照一下命令安装</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><span class=line><span class=comment>#安装</span></span><br><span class=line><span class=built_in>sudo</span> apt-get install openssh-server  <span class=comment># 对于Debian/Ubuntu</span></span><br><span class=line><span class=built_in>sudo</span> yum install openssh-server      <span class=comment># 对于RHEL/CentOS</span></span><br><span class=line><span class=comment>#启动</span></span><br><span class=line><span class=built_in>sudo</span> service ssh start    <span class=comment># 对于系统V（System V）初始化系统</span></span><br><span class=line><span class=built_in>sudo</span> systemctl start ssh  <span class=comment># 对于使用systemd的系统</span></span><br></pre></td></tr></tbody></table></figure><p>在 <code>/etc/ssh/sshd_config</code> 可以调整 ssh 配置，调整前先备份。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>cp</span> /etc/ssh/sshd_config /etc/ssh/backup.sshd_config <span class=comment># 备份好习惯</span></span><br><span class=line><span class=built_in>sudo</span> vim /etc/ssh/sshd_config <span class=comment># 使用vim</span></span><br><span class=line><span class=built_in>sudo</span> nano /etc/ssh/sshd_config <span class=comment># 使用nano</span></span><br><span class=line>sshd -t <span class=comment>#用于测试ssh服务器配置文件是否正确</span></span><br><span class=line><span class=built_in>sudo</span> service ssh restart <span class=comment># 修改完之后重启</span></span><br></pre></td></tr></tbody></table></figure><p>ssh 最常见的用途之一是远程登录到远程服务器或计算机。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>ssh username@remote_host <span class=comment># 替换为你的username和remote_host</span></span><br></pre></td></tr></tbody></table></figure><p>第一次连接服务器大概会出现以下情况。</p><figure class="highlight text"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre></td><td class=code><pre><span class=line>The authenticity of host '1.1.1.1 (1.1.1.1)' can't be established.</span><br><span class=line>ED25519 key fingerprint is SHA256:rqEuH0ymaN0LbB1vPKzRpfgew+5hBusv1/ReDGJ6bDs.</span><br><span class=line>This key is not known by any other names</span><br><span class=line>Are you sure you want to continue connecting (yes/no/[fingerprint])?</span><br><span class=line># 翻译</span><br><span class=line>无法确定主机 "1.1.1.1 (1.1.1.1) "的真实性。</span><br><span class=line>ED25519 密钥指纹为SHA256:rqEuH0ymaN0LbB1vPKzRpfgew+5hBusv1/ReDGJ6bDs。</span><br><span class=line>此密钥没有其他名称</span><br><span class=line>您确定要继续连接（是/否/[指纹]）？</span><br></pre></td></tr></tbody></table></figure><p>这个消息通常是在你首次通过 ssh 连接到一个远程服务器时出现的。它是 ssh 的一种安全机制，目的是确保你连接的服务器确实是你想要连接的服务器，而不是中间人攻击（Man-in-the-Middle Attack）的一部分。</p><p>一般情况下只需按下 "Enter" 即可。接下来就是输入密码，linux 默认输入密码的时候不会有任何提示或者显示。输入完密码再次回车即可登入服务器。以后将不会再次提醒无法验证该服务器的真实性，因为 ssh 客户端将保存该主机的公钥，并在将来的连接中使用它来验证主机的真实性。不过，当服务器修改了公钥或者对系统进行了重置，那么 ssh 客户端会在下一次连接中警告称：</p><figure class="highlight text"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br></pre></td><td class=code><pre><span class=line>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class=line>@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @</span><br><span class=line>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class=line>IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!</span><br><span class=line>Someone could be eavesdropping on you right now (man-in-the-middle attack)!</span><br><span class=line>It is also possible that a host key has just been changed.</span><br><span class=line>The fingerprint for the ECDSA key sent by the remote host is</span><br><span class=line>SHA256: [新的密钥指纹]</span><br><span class=line>Please contact your system administrator.</span><br><span class=line>Add correct host key in /path/to/your/.ssh/known_hosts to get rid of this message.</span><br><span class=line>Offending ECDSA key in /path/to/your/.ssh/known_hosts:1</span><br><span class=line>remove with:</span><br><span class=line>ssh-keygen -f "/path/to/your/.ssh/known_hosts" -R [服务器IP地址]</span><br><span class=line>ECDSA host key for [服务器IP地址] has changed and you have requested strict checking.</span><br><span class=line>Host key verification failed.</span><br><span class=line># 翻译</span><br><span class=line>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class=line></span><br><span class=line>@ 警告：远程主机标识已更改！ @</span><br><span class=line></span><br><span class=line>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class=line>有可能有人在做坏事！</span><br><span class=line>可能有人正在窃听你（中间人攻击）！</span><br><span class=line>也有可能是主机密钥刚刚被更改。</span><br><span class=line>远程主机发送的 ECDSA 密钥的指纹是</span><br><span class=line>sha256: [新的密钥指纹] 请联系系统管理员。</span><br><span class=line>请联系系统管理员。</span><br><span class=line>在 /path/to/your/.ssh/known_hosts 中添加正确的主机密钥，以消除此信息。</span><br><span class=line>在 /path/to/your/.ssh/known_hosts:1 中的违规 ECDSA 密钥</span><br><span class=line>删除：</span><br><span class=line>ssh-keygen -f "/path/to/your/.ssh/known_hosts" -R [服务器 IP 地址] ECDSA 主机密钥。</span><br><span class=line>服务器 IP 地址] 的 ECDSA 主机密钥已更改，您要求进行严格检查。</span><br><span class=line>主机密钥验证失败。</span><br></pre></td></tr></tbody></table></figure><h2 id=ssh无密码登录>ssh 无密码登录</h2><p>我们会发现，每一次连接的时候，服务器都要求我们输入密码。如果我们每一次都使用诸如 <code>ssh username@remote_host</code>+<code>password</code> 的方式，可能会感到十分的厌烦，这时候我们就可以使用 ssh 密钥对来连接到远程服务器。如果私钥没有设置密码，就不需要输入密码。从而达到无密码登录。<code>ssh-keygen</code> 可以生成密钥对，接下来连续三次回车即可生成密钥对，</p><figure class="highlight txt"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br></pre></td><td class=code><pre><span class=line>ssh-keygen -t rsa -b 2048</span><br><span class=line># 生成一个2048位的RSA密钥对,可以选择更长的</span><br><span class=line>❯ ssh-keygen -t rsa -b 2048</span><br><span class=line>Generating public/private rsa key pair.</span><br><span class=line>Enter file in which to save the key (/c/Users/admin/.ssh/id_rsa):# 存储位置（回车）</span><br><span class=line>Enter passphrase (empty for no passphrase): # 可以选择输入密码（回车）</span><br><span class=line>Enter same passphrase again: # 再次输入密码（回车）</span><br><span class=line>Your identification has been saved in /c/Users/admin/.ssh/id_rsa</span><br><span class=line>Your public key has been saved in /c/Users/admin/.ssh/id_rsa.pub</span><br><span class=line>The key fingerprint is:</span><br><span class=line>SHA256:a9G5vG/6Qz6Aptj/cFQsPZtt+DjiAMIBVI9fW/OIENM admin@PC</span><br><span class=line>The key's randomart image is:</span><br><span class=line>+---[RSA 2048]----+</span><br><span class=line>| .o.. o.         |</span><br><span class=line>|   . o oE  o     |</span><br><span class=line>|    o o . + =    |</span><br><span class=line>|   . o o = B *   |</span><br><span class=line>|    o o S.= = o  |</span><br><span class=line>|     . .o=...+   |</span><br><span class=line>|     o o= =+o .  |</span><br><span class=line>|    . o. = o=.   |</span><br><span class=line>|       ...==oo   |</span><br><span class=line>+----[SHA256]-----+</span><br></pre></td></tr></tbody></table></figure><p>此时我们就生成好了一个 2048 位的 RSA 密钥对，此时它存储在 <code>c/Users/admin/.ssh/id_rsa</code> 这个位置，可以从自己的终端看到文件所在位置。接下来我们可以使用 <code>ssh-copy-id</code> 将它复制到远程服务器上。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>ssh-copy-id username@remote-server</span><br></pre></td></tr></tbody></table></figure><p>执行这个命令后，系统会要求您输入远程服务器的密码，然后会将您本地计算机上的 <code>~/.ssh/id_rsa.pub</code>（或其他公钥文件）的内容追加到远程服务器上的 <code>~/.ssh/authorized_keys</code> 文件中。此时，就完成了公钥的复制。此时就已经完成了无密码登录的步骤，以后使用 ssh 连接都只需要输入以下代码即可</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>ssh username@remote-server</span><br></pre></td></tr></tbody></table></figure><p>如果不想用 ssh-copy-id，可以使用 <code>scp</code> 指令，将公钥发送到服务器。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>scp /Users/admin/.ssh/id_rsa.pub username@remote_host:~/.ssh</span><br></pre></td></tr></tbody></table></figure><p>多讲’亿’句。其中，<code>scp</code>（Secure Copy Protocol）是一个用于在本地计算机和远程服务器之间安全地复制文件的命令行工具。基础指令如下。</p><ol><li class=lvl-3><p>可以将本地的文件复制到服务器。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>scp local_file.txt user@remote_server_ip:/path/to/destination/</span><br></pre></td></tr></tbody></table></figure><ul class=lvl-2><li class=lvl-6><p>local_file.txt: 本地文件的路径。</p></li><li class=lvl-6><p>user: 远程服务器上的用户名。</p></li><li class=lvl-6><p>remote_server_ip: 远程服务器的 IP 地址。</p></li><li class=lvl-6><p>/path/to/destination/: 目标目录在远程服务器上的路径。</p></li></ul></li><li class=lvl-3><p>反过来可以将服务器的文件复制回来。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>scp user@remote_server_ip:/path/to/remote_file.txt /local/destination/</span><br></pre></td></tr></tbody></table></figure><ul class=lvl-2><li class=lvl-6><p>user: 远程服务器上的用户名。</p></li><li class=lvl-6><p>remote_server_ip: 远程服务器的 IP 地址。</p></li><li class=lvl-6><p>/path/to/remote_file.txt: 远程服务器上要复制的文件路径。</p></li><li class=lvl-6><p>/local/destination/: 本地目录，用于保存复制的文件。</p></li></ul></li><li class=lvl-3><p>复制整个目录（递归）到远程服务器</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>scp -r local_directory user@remote_server_ip:/path/to/destination/</span><br></pre></td></tr></tbody></table></figure><ul class=lvl-2><li class=lvl-6><p>-r: 表示递归复制，用于复制整个目录。</p></li><li class=lvl-6><p>local_directory: 本地目录的路径</p></li><li class=lvl-6><p>user: 远程服务器上的用户名。</p></li><li class=lvl-6><p>remote_server_ip: 远程服务器的 IP 地址。<br>-/path/to/destination/: 目标目录在远程服务器上的路径，指定复制到远程服务器的位置。</p></li></ul></li><li class=lvl-3><p>复制整个目录（递归）到本机</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>scp -r user@remote_server_ip:/path/to/remote_directory /local/destination/</span><br></pre></td></tr></tbody></table></figure><ul class=lvl-2><li class=lvl-6><p>-r: 表示递归复制，用于复制整个目录。</p></li><li class=lvl-6><p>user: 远程服务器上的用户名。</p></li><li class=lvl-6><p>remote_server_ip: 远程服务器的 IP 地址。</p></li><li class=lvl-6><p>/path/to/remote_directory: 远程服务器上要复制的目录路径。</p></li><li class=lvl-6><p>/local/destination/: 本地目录，用于保存复制的目录。</p></li></ul></li></ol><h3 id=更简便一点>更简便一点</h3><p>经过了刚才<s>繁琐冗赘</s>的说明。此时，我们完成了无密码登录，以后使用 ssh 连接都只需要输入我们想登录的服务器和用户即可登录。那么，我们还可以再简便一点吗？</p><p>当然，这样做还可以更懒一点，比如建立一个 sh 文件。</p><figure class="highlight sh"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br></pre></td><td class=code><pre><span class=line><span class=meta>#!/bin/bash</span></span><br><span class=line></span><br><span class=line><span class=comment># 显示菜单</span></span><br><span class=line><span class=built_in>echo</span> <span class=string>"1, 1.1.1.1"</span></span><br><span class=line><span class=built_in>echo</span> <span class=string>"2, 2.2.2.2"</span></span><br><span class=line><span class=built_in>echo</span> <span class=string>"3, 3.3.3.3"</span></span><br><span class=line><span class=built_in>echo</span> <span class=string>"4, 退出"</span></span><br><span class=line></span><br><span class=line><span class=comment># 获取用户输入</span></span><br><span class=line><span class=built_in>read</span> -p <span class=string>"请选择需要连接的服务器（输入相应的数字）: "</span> choice</span><br><span class=line></span><br><span class=line><span class=comment># 使用 case 语句进行选择</span></span><br><span class=line><span class=keyword>case</span> <span class=variable>$choice</span> <span class=keyword>in</span></span><br><span class=line>    1)</span><br><span class=line>        <span class=built_in>echo</span> <span class=string>"1.1.1.1"</span></span><br><span class=line>        ssh username@1.1.1.1</span><br><span class=line>        ;;</span><br><span class=line>    2)</span><br><span class=line>        <span class=built_in>echo</span> <span class=string>"连接2.2.2.2"</span></span><br><span class=line>        ssh username@2.2.2.2</span><br><span class=line>        ;;</span><br><span class=line>    3)</span><br><span class=line>        <span class=built_in>echo</span> <span class=string>"连接3.3.3.3"</span></span><br><span class=line>        ssh username@3.3.3.3</span><br><span class=line>        ;;</span><br><span class=line>    4)</span><br><span class=line>        <span class=built_in>echo</span> <span class=string>"退出脚本"</span></span><br><span class=line>        <span class=built_in>exit</span> 0</span><br><span class=line>        ;;</span><br><span class=line>    *)</span><br><span class=line>        <span class=built_in>echo</span> <span class=string>"无效的选择，请输入1-4之间的数字"</span></span><br><span class=line>        ;;</span><br><span class=line><span class=keyword>esac</span></span><br></pre></td></tr></tbody></table></figure><p>这下每次只需运行脚本，输入数字即可连接。</p><p>或者说，你的目前在用移动端类 unix\linux 系统（比如 termux，一个适用于 Android 操作系统的开源终端模拟器应用），你打开它的唯一目的就是远程连接服务器，那么我们还可以玩的更极端点，直接使用 <code>alias</code> 来起一个别名。而 <code>alias</code> 是一个用于创建命令别名的 shell 内建命令。别名允许用户为常用的命令或一系列命令定义短而易记的替代名称。<code>alias</code> 基本语法为 <code>alias name='command'</code>。别名只在当前会话中有效，如果您想要使别名在每个新的 shell 会话中都可用，可以将别名定义添加到 shell 配置文件（如～/.bashrc 或～/.bash_profile）中。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>echo</span> <span class=string>'alias link=ssh username@remote_host'</span> &gt;&gt; ~/.bashrc <span class=comment># 使用bash</span></span><br><span class=line><span class=built_in>echo</span> <span class=string>'alias link=ssh username@remote_host'</span> &gt;&gt; ~/.zshrc <span class=comment># 使用zsh</span></span><br></pre></td></tr></tbody></table></figure><p>此时在终端输入 <code>link</code> 即可直接连接到 <code>username@remote_host</code>，<code>alias</code> 只做替换功能，我们完全可以继续使用其他参数诸如 <code>-p</code> 和 <code>-t</code>。</p><blockquote><p>注：termux 好像没有 bashrc，需要自己新建，以上代码可以直接新建。</p></blockquote><h2 id=ssh别名>ssh 别名</h2><p>想必看到这里，你已经基础了解了 ssh 是如何使用的了。尽管刚刚，我们已经会使用 alias 来起一个别名，但是就我而言，我其实并不喜欢为 ssh 专门新建一个 alias。那么，难道我们每一次都要完整的输入一次 <code>ssh username@remote_host</code> 吗？其实 ssh 也有一个专门的配置文件来帮助你为不同的 SSH 连接设置简短易记的别名，从而简化连接命令。<br>SSH 别名可以通过配置文件 <code>.ssh/config</code> 实现，这个文件位于用户的主目录下 <code>~/.ssh/config</code>。如果文件不存在，你可以手动创建它。</p><p>基本的配置如下所示：</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><span class=line>Host myserver</span><br><span class=line>    HostName remote_host</span><br><span class=line>    User  username</span><br><span class=line>    Port  22</span><br><span class=line>    IdentityFile ~/.ssh/id_rsa</span><br></pre></td></tr></tbody></table></figure><ul class=lvl-0><li class=lvl-2><p>Host: 自定义别名。在连接时使用这个名称，而不需要输入完整的主机名。</p></li><li class=lvl-2><p>HostName: 实际的主机名或 IP 地址。</p></li><li class=lvl-2><p>User: 登录所使用的用户名。</p></li><li class=lvl-2><p>Port: 服务器的 SSH 端口。如果不是默认的 22 端口，则需要指定。</p></li><li class=lvl-2><p>IdentityFile: 私钥文件路径。如果你有多个私钥文件，可以指定特定的文件。</p></li></ul><p>配置好别名后，你只需要使用 ssh 命令加上别名即可：</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>ssh myserver </span><br><span class=line><span class=comment>#同等于ssh -i  ~/.ssh/id_rsa username@remote_host -p 22</span></span><br></pre></td></tr></tbody></table></figure><p>还有一件事。使用 SSH 别名后，<strong>仍然需要密钥进行无密码登录</strong>，但 SSH 别名可以让连接过程更加简便。</p><h3 id=ssh别名的其他选项>ssh 别名的其他选项</h3><p>一般情况下，以上的配置就已经够用了。不过还有一些选项有时候也是会用上的。</p><h4 id=ForwardAgent>ForwardAgent</h4><p>ForwardAgent，它允许将本地 SSH 代理转发到远程服务器，从而使你可以在连接到远程服务器后，无需重新输入密码或私钥，即可在远程服务器上发起其他 SSH 连接。说的再详细一点就是：SSH Agent 的功能是，你只需要在本地机器上解锁一次私钥，后续的 SSH 连接会使用这个已经解锁的密钥，而不需要你再次输入密码。那么，ForwardAgent 是用来将本机的 SSH 代理转发到远程机器上，使得远程机器可以利用本机的 SSH 代理进行进一步的 SSH 连接。通过 ForwardAgent，在第一台机器上启动了 SSH 代理，之后连接到第二台机器时，这个代理会被转发到第二台机器上。然后第二台机器就可以使用在第一台机器上的密钥来进行连接，从而实现无密码登录，而不用将密钥拷贝到中间机器上。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>Host server</span><br><span class=line>    ForwardAgent <span class=built_in>yes</span></span><br></pre></td></tr></tbody></table></figure><h4 id=ServerAliveInterval-和-ServerAliveCountMax>ServerAliveInterval 和 ServerAliveCountMax</h4><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>Host server</span><br><span class=line>    ServerAliveInterval 60</span><br><span class=line>    ServerAliveCountMax 3</span><br></pre></td></tr></tbody></table></figure><p>ServerAliveInterval: 通过设置一个间隔来发送 keep-alive 消息，防止连接断开。详细点说就是：定义 SSH 客户端在多长时间内（以秒为单位）没有收到服务器响应时，会主动发送 keep-alive 消息以检查连接是否仍然有效。这个选项有助于防止长时间闲置的 SSH 连接因超时而断开。</p><p>ServerAliveCountMax：设置在没有收到服务器响应的情况下，客户端可以发送多少次保持活动信号。</p><h2 id=其他的指令>其他的指令</h2><p>既然都讲到这里了，不如再多讲讲有关 ssh 的知识。现在说说 <code>-t</code> 选项。<code>-t</code> 是 ssh 命令的一个选项，用于在远程服务器上分配一个伪终端，在某些情况很有用。例子:</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><span class=line>ssh -t username@remote_host <span class=string>'sudo apt update &amp;&amp; sudo apt upgrade'</span></span><br><span class=line>Hit:1 http://mirrors.cloud.aliyuncs.com/debian bullseye InRelease</span><br><span class=line>......</span><br><span class=line>0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.</span><br><span class=line>Connection to remote_host closed.</span><br><span class=line> ~/</span><br></pre></td></tr></tbody></table></figure><p>可以看到，此时参数 <code>-t</code> 表示要分配一个伪终端（pseudo-tty）。在执行完 <code>sudo apt update &amp;&amp; sudo apt upgrade</code> 后，伪终端则是会立即关闭。这种行为是由于指令执行完毕后没有额外的交互需要，所以终端会自动关闭。可以增加一个 <code>&amp;&amp;bash</code> 来启动一个新的 <code>bash</code> 会话，能够在保持 ssh 连接的情况下继续与服务器互动。但是我暂时还不知道这个能用来干什么。🤔</p><p>看了一下文档，发现 ssh 还有用作代理的方法，使用 <code>-D 端口号</code>参数，即可指定动态端口转发，创建一个 SOCKS 代理服务器，该代理服务器将在本地计算机的指定端口上监听。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>ssh -D 1080 username@remote_host</span><br></pre></td></tr></tbody></table></figure><p>以上代码建立了一个 ssh，它将在本地计算机的 1080 端口上监听，并且转发流量。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>ssh -fNCqTn -D 1080 username@remote_host </span><br><span class=line><span class=comment># 加这么多参数好像有点重复，实际使用上可以看需删减参数</span></span><br></pre></td></tr></tbody></table></figure><p>如果我们使用 ssh 作为代理的话，可以用以下的参数</p><ul class=lvl-0><li class=lvl-2><p>-f：将 ssh 连接放到后台运行，使其在后台运行，以便您可以继续使用终端。</p></li><li class=lvl-2><p>-N：告诉 ssh 不要执行任何远程命令，它只会建立连接而不执行任何额外的命令。</p></li><li class=lvl-2><p>-C: 启用数据压缩。这将通过 zlib 库对传输的数据进行压缩，以减小传输的数据量。</p></li><li class=lvl-2><p>-q: 静默模式。该选项用于减少输出，使 ssh 在执行时更为静默，不输出不必要的信息。</p></li><li class=lvl-2><p>-T: 禁用伪终端分配。通常，ssh 会为远程连接分配伪终端，但使用 -T 选项会禁用这个分配，适用于不需要交互的连接。</p></li><li class=lvl-2><p>-n: 防止远程命令执行时，ssh 从标准输入读取数据。</p></li></ul><p>而 <code>-L</code> 也是大差不差。在使用 <code>-L</code> 选项时，可本地主机上的一个端口映射到远程主机的指定端口。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>ssh -L 9999:example.org:80 -N -T username@remote_host</span><br></pre></td></tr></tbody></table></figure><p>此时，访问 local:9999 即为访问 example.org:80<br>这个 ssh 命令的目的是通过 ssh 隧道将本地端口（localhost:9999）转发到远程主机（<span class=exturl data-url=aHR0cDovL2V4YW1wbGUub3Jn>example.org<i class="fa fa-external-link-alt"></i></span>）的端口 80。</p><p><code>-J</code>，这个 ssh 参数是用于通过跳板主机（jumphost）连接到远程服务器的。跳板主机充当一个中间站，帮助我们间接地连接到目标服务器。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>ssh -J username@jump_host username@remote_host</span><br></pre></td></tr></tbody></table></figure><p><code>-J</code>: 指定跳板主机，表示要通过跳板主机连接到目标服务器。</p><p>可以用来连接当作外网连接内网的跳板机。而在一些安全要求较高的环境中，跳板主机可以作为一个堡垒机（Bastion Host），所有外部连接都必须先通过堡垒机，再通过内部网络连接到其他服务器。还有的时候需要通过多个跳板主机才能达到目标服务器，这就形成了一个跳板链。通过 ssh 的 - J 选项，可以指定多个跳板主机，以建立跳板链。比如 <code>ssh -J user1@jump_host1,user2@jump_host2 user@remote_host</code></p><p>累了，不想写了。over.😇</p><p>参考：</p><blockquote><p><span class=exturl data-url="aHR0cHM6Ly90bGRyLmluYnJvd3Nlci5hcHAvcGFnZXMvY29tbW9uL3NzaA==">ssh | tldr InBrowser.App<i class="fa fa-external-link-alt"></i></span><br><span class=exturl data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC81NzYzMDYzMw==">ssh 命令的三种代理功能（-L/-R/-D）<i class="fa fa-external-link-alt"></i></span></p></blockquote><h2 id=记录>记录</h2><ul class=lvl-0><li class=lvl-2><p>2024-02-02 初稿完成。</p></li><li class=lvl-2><p>2024-02-10 订正初稿，发布。</p></li><li class=lvl-2><p>2024-05-10 更新杂七杂八的其他指令.</p></li><li class=lvl-2><p>2024-10-20 更新 ssh 别名，和 ServerAliveInterval、ForwardAgent、ProxyJump 讲解。</p></li></ul><p>无关紧要的念念碎：怎么这玩意越写越多了，而且的 ssh 内容真的好多啊，再写下去还不如去看官方文档了。</p></div><footer class=post-footer><div class=post-copyright><ul><li class=post-copyright-author><strong>本文作者：</strong> 水氵冫</li><li class=post-copyright-link><strong>本文链接：</strong> <a href=https://yuuu.org/post/64202.html title="13.ssh 知识整理">https://yuuu.org/post/64202.html</a></li><li class=post-copyright-license><strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<span class=exturl data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div><div class=post-tags><a href=/tags/%E5%AD%A6%E4%B9%A0/ rel=tag><i class="fa fa-tag"></i> 学习</a></div><div class=post-nav><div class=post-nav-item><a href=/post/17812.html rel=prev title="12. 使用了双拼一段时间之后"><i class="fa fa-angle-left"></i> 12. 使用了双拼一段时间之后</a></div><div class=post-nav-item><a href=/post/24530.html rel=next title="14.malloc 的微浅理解">14.malloc 的微浅理解<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class=comments><div id=twikoo-comments></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; 2023 – <span itemprop=copyrightYear>2025</span><span class=with-love><i class="fa fa-heart"></i></span> <span class=author itemprop=copyrightHolder>水氵冫</span></div><div class=wordcount><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-chart-line"></i></span> <span>站点总字数：</span> <span title=站点总字数>36k</span></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-coffee"></i></span> <span>站点阅读时长 &asymp;</span> <span title=站点阅读时长>2:12</span></span></div><a style=color:#999;border-bottom:none!important ; href="https://icp.gov.moe/?keyword=20242424" target=_blank>萌ICP备20242424号</a></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div class=back-to-top role=button aria-label=返回顶部><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin=anonymous></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script src=/js/bookmark.js></script><script src=/js/pjax.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.24.0/algoliasearch-lite.umd.js integrity="sha256-b2n6oSgG4C1stMT/yc/ChGszs9EY/Mhs6oltEjQbFCQ=" crossorigin=anonymous></script><script src=/js/third-party/search/algolia-search.js></script><script src=/js/third-party/pace.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin=anonymous></script><script class=next-config data-name=quicklink type=application/json>{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://yuuu.org/post/64202.html"}</script><script src=/js/third-party/quicklink.js></script><script class=next-config data-name=twikoo type=application/json>{"enable":true,"visitor":false,"envId":"https://twikoo.yuuu.org","el":"#twikoo-comments"}</script><script>document.addEventListener("page:loaded",(()=>{NexT.utils.loadComments(CONFIG.twikoo.el).then((()=>NexT.utils.getScript(CONFIG.twikoo.jsUrl||"https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js",{condition:window.twikoo}))).then((()=>{twikoo.init(CONFIG.twikoo)}))}))</script><style>.comments,.post-block{overflow:visible}.tk-owo-emotion{display:inline-block}</style><script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.2/anime.min.js></script><script>var canvasEl=document.createElement("canvas");canvasEl.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:9999999",document.body.appendChild(canvasEl);var ctx=canvasEl.getContext("2d"),numberOfParticules=30,pointerX=0,pointerY=0,tap="click",colors=["rgba(255,182,185,.9)","rgba(250,227,217,.9)","rgba(187,222,214,.9)","rgba(138,198,209,.9)"];function setCanvasSize(){canvasEl.width=2*window.innerWidth,canvasEl.height=2*window.innerHeight,canvasEl.style.width=window.innerWidth+"px",canvasEl.style.height=window.innerHeight+"px",canvasEl.getContext("2d").scale(2,2)}function updateCoords(e){pointerX=e.clientX||e.touches&&e.touches[0].clientX,pointerY=e.clientY||e.touches&&e.touches[0].clientY}function setParticuleDirection(e){var a=anime.random(0,360)*Math.PI/180,t=anime.random(50,180),n=[-1,1][anime.random(0,1)]*t;return{x:e.x+n*Math.cos(a),y:e.y+n*Math.sin(a)}}function createParticule(e,a){var t={};return t.x=e,t.y=a,t.color=colors[anime.random(0,colors.length-1)],t.radius=anime.random(16,32),t.endPos=setParticuleDirection(t),t.draw=function(){ctx.beginPath(),ctx.arc(t.x,t.y,t.radius,0,2*Math.PI,!0),ctx.fillStyle=t.color,ctx.fill()},t}function createCircle(e,a){var t={};return t.x=e,t.y=a,t.color="#FFF",t.radius=.1,t.alpha=.5,t.lineWidth=6,t.draw=function(){ctx.globalAlpha=t.alpha,ctx.beginPath(),ctx.arc(t.x,t.y,t.radius,0,2*Math.PI,!0),ctx.lineWidth=t.lineWidth,ctx.strokeStyle=t.color,ctx.stroke(),ctx.globalAlpha=1},t}function renderParticule(e){for(var a=0;a<e.animatables.length;a++)e.animatables[a].target.draw()}function animateParticules(e,a){for(var t=createCircle(e,a),n=[],i=0;i<numberOfParticules;i++)n.push(createParticule(e,a));anime.timeline().add({targets:n,x:function(e){return e.endPos.x},y:function(e){return e.endPos.y},radius:.1,duration:anime.random(1200,1800),easing:"easeOutExpo",update:renderParticule}).add({targets:t,radius:anime.random(80,160),lineWidth:0,alpha:{value:0,easing:"linear",duration:anime.random(600,800)},duration:anime.random(1200,1800),easing:"easeOutExpo",update:renderParticule},0)}var render=anime({duration:1/0,update:function(){ctx.clearRect(0,0,canvasEl.width,canvasEl.height)}});document.addEventListener(tap,(function(e){render.play(),updateCoords(e),animateParticules(pointerX,pointerY)}),!1),setCanvasSize(),window.addEventListener("resize",setCanvasSize,!1)</script><script>document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector("body"),t=document.getElementById("g-pointer-1"),n=document.getElementById("g-pointer-2");let o;if(!t||!n)return void console.error("元素未找到");const i=t.offsetWidth/2,s=n.offsetWidth/2;e.addEventListener("mousemove",(function(e){t.classList.add("pointer-visible"),n.classList.add("pointer-visible"),window.requestAnimationFrame((()=>{var o,r;o=e.clientX,r=e.clientY,t.style.transform=`translate(${o-i}px, ${r-i}px)`,n.style.transform=`translate(${o-s}px, ${r-s}px)`})),clearTimeout(o),o=setTimeout((()=>{t.classList.remove("pointer-visible"),n.classList.remove("pointer-visible")}),1e3)}))}))</script><div id=g-pointer-1></div><div id=g-pointer-2></div><canvas id=map></canvas><script src=https://cdn.jsdelivr.net/gh/lrsjng/pagemap/dist/pagemap.min.js></script><script>pagemap(document.querySelector("#map"),{viewport:null,styles:{"header,footer,section,article":"rgba(0,0,0,0.08)","h1,a":"rgba(0,0,0,0.10)","h2,h3,h4":"rgba(0,0,0,0.08)"},back:"rgba(0,0,0,0.02)",view:"rgba(0,0,0,0.05)",drag:"rgba(0,0,0,0.10)",interval:null})</script><script>document.addEventListener("DOMContentLoaded",(function(){if(/Android|iPhone|iPad|iPod|Windows Phone/i.test(navigator.userAgent)){["g-pointer-1","g-pointer-2"].forEach((e=>{let n=document.getElementById(e);n&&(n.style.display="none")}))}}))</script></body></html>