<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content=#222 media="(prefers-color-scheme: light)"><meta name=theme-color content=#222 media="(prefers-color-scheme: dark)"><meta name=generator content="Hexo 7.3.0"><link rel=preconnect href=https://cdnjs.cloudflare.com crossorigin><link rel=apple-touch-icon sizes=180x180 href=https://cdn.yuuu.org/img/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://cdn.yuuu.org/img/favicon-192x192.png><link rel=icon type=image/png sizes=16x16 href=https://cdn.yuuu.org/img/favicon-32x32.png><link rel=mask-icon href=/images/logo.svg color=#222><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/black/pace-theme-minimal.css><script src=https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin=anonymous></script><script class=next-config data-name=main type=application/json>{"hostname":"yuuu.org","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.21.1","exturl":true,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12,"width":270},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"algolia":{"appID":"8TVS4A6TL8","apiKey":"95c1ff21ae4344bc69e9710b99d7d617","indexName":"blog","hits":{"per_page":10}}}</script><script src=/js/config.js></script><meta name=description content="近日想在 ubuntu 上录一个屏，于是我安装了 obs，但是打开后才发现屏幕捕捉只是黑屏一片，只有一个鼠标可以显示。上网搜索一番在知道，大概是 ubuntu 的自带的显卡驱动 nouveau 的问题。所以最好的解决方法大概就是安装英伟达显卡的驱动。"><meta property=og:type content=article><meta property=og:title content="7.ubuntu 显卡安装小记"><meta property=og:url content=https://yuuu.org/post/54849.html><meta property=og:site_name content=微霞><meta property=og:description content="近日想在 ubuntu 上录一个屏，于是我安装了 obs，但是打开后才发现屏幕捕捉只是黑屏一片，只有一个鼠标可以显示。上网搜索一番在知道，大概是 ubuntu 的自带的显卡驱动 nouveau 的问题。所以最好的解决方法大概就是安装英伟达显卡的驱动。"><meta property=og:locale content=zh_CN><meta property=og:image content=https://cdn.yuuu.org/post-img/7/1.webp><meta property=og:image content=https://cdn.yuuu.org/post-img/7/2.webp><meta property=og:image content=https://cdn.yuuu.org/post-img/7/3.webp><meta property=og:image content=https://cdn.yuuu.org/post-img/7/4.webp><meta property=og:image content=https://cdn.yuuu.org/post-img/7/5.webp><meta property=article:published_time content=2023-08-06T00:58:05.000Z><meta property=article:modified_time content=2023-08-06T00:58:05.000Z><meta property=article:author content=水氵冫><meta property=article:tag content=折腾><meta name=twitter:card content=summary><meta name=twitter:image content=https://cdn.yuuu.org/post-img/7/1.webp><link rel=canonical href=https://yuuu.org/post/54849.html><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://yuuu.org/post/54849.html","path":"post/54849.html","title":"7.ubuntu 显卡安装小记"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>7.ubuntu 显卡安装小记 | 微霞</title><link rel=stylesheet href=https://cdn.yuuu.org/font/LXGW/result.css><script async src=https://umami.yuuu.org/script.js data-website-id=ac8efb9c-b964-450e-a0a8-d2ee9dc38911 data-cache=true></script><script type=application/ld+json>{
      "@context" : "https://yuuu.org",
      "@type" : "WebSite",
      "name" : "微霞",
      "alternateName" : "微霞",
      "url" : "https://yuuu.org"
    }</script><style>.tk-expand-wrap .tk-expand{width:80%}</style><noscript><link rel=stylesheet href=/css/noscript.css></noscript><link rel=alternate href=/atom.xml title=微霞 type=application/atom+xml><link rel=alternate href=/rss2.xml title=微霞 type=application/rss+xml></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><p class=site-title>微霞</p><i class=logo-line></i></a><p class=site-subtitle itemprop=description>水风清，晚霞明</p></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-rss"><a href=/atom.xml rel=section><i class="fa fa-rss fa-fw"></i>RSS</a></li><li class="menu-item menu-item-友链"><a href=/links rel=section><i class="fa fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-番剧"><a href=/bangumis/index.html rel=section><i class="fa fa-play-circle fa-fw"></i>番剧</a></li><li class="menu-item menu-item-追剧"><a href=/cinemas/index.html rel=section><i class="fas fa-video fa-fw"></i>追剧</a></li><li class="menu-item menu-item-书籍"><a href=/books/index.html rel=section><i class="fas fa-book fa-fw"></i>书籍</a></li><li class="menu-item menu-item-search"><a role=button class=popup-trigger><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class=search-result-container><div class=search-result-icon><i class="fab fa-algolia fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%BF%AE%E5%A4%8D%E9%A9%B1%E5%8A%A8><span class=nav-number>1.</span> <span class=nav-text>修复驱动</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%8C%82%E8%BD%BD%E7%A1%AC%E7%9B%98%E5%92%8C%E5%90%AF%E7%94%A8%E5%BF%85%E8%A6%81%E7%9A%84%E8%99%9A%E6%8B%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F><span class=nav-number>1.1.</span> <span class=nav-text>挂载硬盘和启用必要的虚拟文件系统</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%BF%9B%E5%85%A5chroot%E8%BF%9B%E8%A1%8C%E4%BF%AE%E5%A4%8D><span class=nav-number>1.2.</span> <span class=nav-text>进入 chroot 进行修复</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8D%B8%E8%BD%BD%E8%99%9A%E6%8B%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F><span class=nav-number>1.3.</span> <span class=nav-text>卸载虚拟文件系统</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%AE%89%E8%A3%85%E8%8B%B1%E4%BC%9F%E8%BE%BE%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8><span class=nav-number>2.</span> <span class=nav-text>安装英伟达显卡驱动</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%B8%8B%E8%BD%BD%E9%A9%B1%E5%8A%A8%E5%92%8C%E9%99%84%E5%8A%A0%E7%BB%84%E4%BB%B6><span class=nav-number>2.1.</span> <span class=nav-text>下载驱动和附加组件</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%AE%89%E8%A3%85%E7%BB%84%E4%BB%B6%E5%92%8C%E6%B8%85%E7%90%86%E9%A9%B1%E5%8A%A8><span class=nav-number>2.2.</span> <span class=nav-text>安装组件和清理驱动</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%A6%81%E7%94%A8nouveau><span class=nav-number>2.3.</span> <span class=nav-text>禁用 nouveau</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85%E9%A9%B1%E5%8A%A8><span class=nav-number>2.4.</span> <span class=nav-text>开始安装驱动</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%90%8E%E8%AE%B0><span class=nav-number>3.</span> <span class=nav-text>后记</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%AF%E8%83%BD%E9%81%87%E5%88%B0%E7%9A%84%E9%94%99%E8%AF%AF><span class=nav-number>3.1.</span> <span class=nav-text>可能遇到的错误</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E9%81%AD%E9%81%87><span class=nav-number>3.2.</span> <span class=nav-text>遭遇</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5><span class=nav-number>3.3.</span> <span class=nav-text>参考链接</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=水氵冫 src=https://cdn.yuuu.org/img/avatar.avif><p class=site-author-name itemprop=name>水氵冫</p><div class=site-description itemprop=description>这是一个分享技术、生活和思考的个人博客，记录成长的点滴.</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>21</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang=zh-CN><link itemprop=mainEntityOfPage href=https://yuuu.org/post/54849.html><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=https://cdn.yuuu.org/img/avatar.avif><meta itemprop=name content=水氵冫></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=微霞><meta itemprop=description content=这是一个分享技术、生活和思考的个人博客，记录成长的点滴.></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="7.ubuntu 显卡安装小记 | 微霞"><meta itemprop=description content=""></span><header class=post-header><h1 class=post-title itemprop="name headline">7.ubuntu 显卡安装小记</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span> <span class=post-meta-item-text>发表于</span> <time title="创建时间：2023-08-06 08:58:05" itemprop="dateCreated datePublished" datetime=2023-08-06T08:58:05+08:00>2023-08-06</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder"></i></span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E6%8A%98%E8%85%BE/ itemprop=url rel=index><span itemprop=name>折腾</span></a></span></span><span class=post-meta-break></span><span class=post-meta-item title=本文字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span> <span class=post-meta-item-text>本文字数：</span> <span>3.4k</span></span><span class=post-meta-item title=阅读时长><span class=post-meta-item-icon><i class="far fa-clock"></i></span> <span class=post-meta-item-text>阅读时长 &asymp;</span> <span>12 分钟</span></span></div></div></header><div class=post-body itemprop=articleBody><p>近日想在 ubuntu 上录一个屏，于是我安装了 obs，但是打开后才发现屏幕捕捉只是黑屏一片，只有一个鼠标可以显示。上网搜索一番在知道，大概是 ubuntu 的自带的显卡驱动 nouveau 的问题。所以最好的解决方法大概就是安装英伟达显卡的驱动。<span id=more></span>以我在 windows 上的操作逻辑，当然是直接在可视化界面中的「软件与更新」里面寻找显卡驱动，然后直接更新，可这就是悲剧的开始。在 ubuntu 中的「软件和更新」中选择了图中的「NVIDIA Server Driver metapackage 来自 nvidia-driver-535-server (专有)」进行更新。安装完成后，它要求重启来完成安装。可当重启后，却是只显示几行代码。我不懂’SGX’和’ucsi-ccg’是什么意思，但是看到 nvidia-gpu 和 error 的时候，我大概明白，应该是安装出的问题：英伟达显卡超时错误。<img data-src=https://cdn.yuuu.org/post-img/7/1.webp alt="" loading=lazy><br>我尝试着用 alt + ctrl + f1 进入 tty1 虚拟控制台，但是毫无反应，重复用 alt + ctrl + f1/2/3/4/5/6 来试图进入 tty1/2/3/4/5/6，偶有几次成功，但是却会在数秒后无征兆退回最初的错误页面。几番尝试全都无果告终，重启好几次都只是卡在以上的界面。网络上的解决教程几乎都是围绕着进入命令行开始修复的，却没有像我这般卡死在「外边」的。但是，我手里留有一个安装 ubuntu 的 u 盘。里面还有 ubuntu 的镜像。通过可以 live usb 中 try ubuntu 可以试用其中的 ubuntu 系统，虽然应该是一个最小安装的系统，但是也不妨碍我们用它来救救火。</p><h2 id=修复驱动>修复驱动</h2><p>插入 u 盘，选择该 u 盘并启动其中的 ubuntu 镜像。在最开始的页面中选择「试用 ubuntu」进入 ubuntu 系统。</p><p>接下来，打开终端，开始挂载安装本机中安装了 ubuntu 的硬盘。在此之前，先确定安装 ubuntu 的盘在哪个物理磁盘上。用 <code>parted</code> 指令或者 <code>fdisk</code> 均可。我电脑有两块 128GB 的 SSD 硬盘，有点容易搞混，parted 可以显示硬盘名字，增加区分度。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> fdisk -l</span><br><span class=line><span class=comment># 如果用fdisk还是不知道在哪个盘试试下面这个parted</span></span><br><span class=line><span class=built_in>sudo</span> parted -l</span><br></pre></td></tr></tbody></table></figure><p><img data-src=https://cdn.yuuu.org/post-img/7/2.webp alt="" loading=lazy><br>如图所示，这里这里有两个盘，文件系统为 <code>ntfs</code> 的是 windows 系统所在的盘，<code>ext4</code> 则是 ubuntu 系统所在的盘。我所要挂载的盘是 /dev/sdb，各位要根据实际进行修改。</p><h3 id=挂载硬盘和启用必要的虚拟文件系统>挂载硬盘和启用必要的虚拟文件系统</h3><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class=comment># 将硬盘上的 Ubuntu 根分区挂载到 `/mnt` 目录，访问和操作其中的文件和目录</span></span><br><span class=line><span class=built_in>sudo</span> mount /dev/sdb /mnt </span><br></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre></td><td class=code><pre><span class=line><span class=comment># 在 chroot 环境中访问和使用系统中的设备文件。</span></span><br><span class=line><span class=built_in>sudo</span> mount --<span class=built_in>bind</span> /dev /mnt/dev </span><br><span class=line></span><br><span class=line><span class=comment># 在 chroot 环境中使用终端功能。</span></span><br><span class=line><span class=built_in>sudo</span> mount --<span class=built_in>bind</span> /dev/pts /mnt/dev/pts </span><br><span class=line></span><br><span class=line><span class=comment># 在 chroot 环境中访问和操作系统内核和进程的相关信息。</span></span><br><span class=line><span class=built_in>sudo</span> mount --<span class=built_in>bind</span> /proc /mnt/proc</span><br><span class=line></span><br><span class=line><span class=comment># 在 chroot 环境中访问和操作系统硬件和设备的相关信息。</span></span><br><span class=line><span class=built_in>sudo</span> mount --<span class=built_in>bind</span> /sys /mnt/sys</span><br></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line><span class=comment># 切换当前的根目录到 `/mnt`,</span></span><br><span class=line><span class=comment># 通过使用 chroot，我们可以在一个隔离的环境中运行命令，让其以为这个环境是真正的根目录，</span></span><br><span class=line><span class=comment># 从而可以进行系统操作、安装软件。</span></span><br><span class=line><span class=built_in>sudo</span> <span class=built_in>chroot</span> /mnt </span><br></pre></td></tr></tbody></table></figure><p>综合起来，这些命令的逻辑是将硬盘上的 Ubuntu 根分区挂载到 <code>/mnt</code>，然后通过绑定虚拟文件系统和使用 chroot，创建一个隔离的环境，以便在其中操作和管理您的 Ubuntu 系统。这样做可以方便地进行修复、配置或管理系统，而不会影响到主机系统。</p><h3 id=进入chroot进行修复>进入 chroot 进行修复</h3><p>进到 chroot 环境中就可以正式开始修复了。先卸载可能已经安装了的 NVIDIA 驱动。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> apt-get purge nvidia-*  <span class=comment># 删除所有 NVIDIA 显卡驱动程序及其相关的软件包</span></span><br><span class=line><span class=built_in>sudo</span> apt-get autoremove  <span class=comment># 移除系统上已经不再需要的软件包</span></span><br></pre></td></tr></tbody></table></figure><p>然后安装回默认的 Nouveau 驱动</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> apt-get install xserver-xorg-video-nouveau</span><br></pre></td></tr></tbody></table></figure><p>我的电脑无法正常进入系统，也无法进入 tty 模式，可能在系统引导出了问题，这里我更新一下 grub，预防万一。正常情况下应该是不需要执行的。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>update-grub</span><br></pre></td></tr></tbody></table></figure><p>在 chroot 环境中完成修复后，退出 chroot</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>exit</span></span><br></pre></td></tr></tbody></table></figure><h3 id=卸载虚拟文件系统>卸载虚拟文件系统</h3><p>退出 chroot 后，卸载之前挂载的虚拟文件系统：相反的顺序卸载虚拟文件系统，以确保没有依赖关系。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> umount /mnt/sys</span><br><span class=line><span class=built_in>sudo</span> umount /mnt/proc</span><br><span class=line><span class=built_in>sudo</span> umount /mnt/dev/pts</span><br><span class=line><span class=built_in>sudo</span> umount /mnt/dev</span><br></pre></td></tr></tbody></table></figure><p>最后，卸载硬盘分区。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> umount /mnt</span><br></pre></td></tr></tbody></table></figure><p>现在就可以关闭系统，卸载 u 盘，然后重启了。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> rebot</span><br></pre></td></tr></tbody></table></figure><p>重启后看到了久违的系统桌面，总算是救援成功。🥳</p><h2 id=安装英伟达显卡驱动>安装英伟达显卡驱动</h2><p>虽然电脑是救回来了，但我还是想安装显卡驱动，这个该怎么做？既然系统内自带的 “软件和更新” 程序没法正常更新，我打算手动安装驱动。</p><h3 id=下载驱动和附加组件>下载驱动和附加组件</h3><p>在<span class=exturl data-url="aHR0cHM6Ly93d3cubnZpZGlhLmNuL0Rvd25sb2FkL2luZGV4LmFzcHg/bGFuZz1jbg==">官方驱动 | NVIDIA<i class="fa fa-external-link-alt"></i></span>可以通过条件选取选择到适合自己的驱动。不知道显卡驱动的话，可以用以下指令查看。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>lspci | grep -i vga </span><br></pre></td></tr></tbody></table></figure><p>通过下载我们会得到一个.run 的文件。这个文件先放好，一会用上。</p><h3 id=安装组件和清理驱动>安装组件和清理驱动</h3><p>现在我们安装一些必备 / 可选的驱动，考虑到各种问题，我还是把一些大概用不上但是可能用的上的组件给加上了。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> apt-get update   <span class=comment># 更新软件列表</span></span><br><span class=line></span><br><span class=line><span class=built_in>sudo</span> apt-get install g++ <span class=comment># 安装gcc套件</span></span><br><span class=line></span><br><span class=line><span class=built_in>sudo</span> apt-get install gcc  <span class=comment># 安装gcc套件</span></span><br><span class=line></span><br><span class=line><span class=built_in>sudo</span> apt-get install make  <span class=comment># 安装make</span></span><br><span class=line></span><br><span class=line><span class=built_in>sudo</span> apt install linux-headers-$(<span class=built_in>uname</span> -r) <span class=comment># 安装内核头文件 (可选)</span></span><br><span class=line></span><br><span class=line><span class=built_in>sudo</span> apt install xorg <span class=comment># 安装 X Window System(可选)</span></span><br><span class=line></span><br><span class=line><span class=built_in>sudo</span> apt install libgl1-mesa-dev <span class=comment># 安装 OpenGL 库和开发工具(可选)</span></span><br></pre></td></tr></tbody></table></figure><p>卸载所有英伟达显卡驱动，为了避免之前安装的驱动对我们造成影响。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> apt-get remove --purge nvidia*</span><br></pre></td></tr></tbody></table></figure><h3 id=禁用nouveau>禁用 nouveau</h3><p>接下来禁用 nouveau，在 blacklist 中禁用。</p><blockquote><p><code>/etc/modprobe.d/blacklist.conf</code> 是一个配置文件，用于在 Linux 系统中禁用或屏蔽特定的内核模块（驱动程序）加载。在 Linux 系统中，内核模块是用于支持硬件设备、文件系统或其他核心功能的一种动态加载的软件组件。<code>/etc/modprobe.d/blacklist.conf</code> 文件允许您指定要禁用的内核模块，以防止其加载。当您在 <code>/etc/modprobe.d/blacklist.conf</code> 文件中添加一个模块的条目时，系统会在启动时检查该文件，并在加载内核模块时跳过指定的模块。这对于解决某些硬件或软件相关的问题非常有用，例如禁用冲突的驱动程序或不需要的功能模块。在该文件中，每个禁用的内核模块条目通常以 <code>blacklist</code> 关键字开头，后跟要禁用的模块的名称。</p></blockquote><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class=comment># 打开并编辑blacklist.conf</span></span><br><span class=line><span class=built_in>sudo</span> gedit /etc/modprobe.d/blacklist.conf</span><br></pre></td></tr></tbody></table></figure><p>加入以下两行，禁用 Nouveau 驱动程序</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line><span class=comment># 禁用 Nouveau 驱动程序，阻止 Nouveau 驱动程序在系统启动时加载</span></span><br><span class=line>blacklist nouveau</span><br><span class=line><span class=comment># 禁用 Nouveau 驱动程序的内核模式设置</span></span><br><span class=line>options nouveau modeset=0</span><br></pre></td></tr></tbody></table></figure><p>最后更新一下 initramfs，主要还是担心之前的引导问题。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> update-initramfs –u  <span class=comment># -u参数表示 "update"</span></span><br></pre></td></tr></tbody></table></figure><blockquote><p>在 Linux 系统启动时，initramfs 是一个非常小的文件系统，它包含了一些基本的工具、驱动程序和文件，用于在正式的根文件系统被挂载之前进行初始化和准备工作。它的主要目的是为了确保系统能够正确地启动并加载所需的驱动程序和文件系统。<br>initramfs 中包含了用于加载真正的根文件系统所需的驱动程序、模块、配置文件和其他必要的工具。它允许系统在启动过程中进行硬件检测、初始化设备、加载必要的驱动程序和模块，以及解决其他启动过程中可能遇到的问题。一旦 initramfs 完成了启动过程中的初始化和准备工作，它会将控制权转交给真正的根文件系统，然后真正的根文件系统会被挂载到系统上，从而完成整个启动过程。</p></blockquote><p>重启后看看是否可以进入系统，此时进入「软件与更新」，则会提示说我们在使用备用驱动。<br><img data-src=https://cdn.yuuu.org/post-img/7/3.webp alt="" loading=lazy></p><h3 id=开始安装驱动>开始安装驱动</h3><p>接下来就是进入命令行了。可以使用 <code>sudo telinit 3</code> 和 <code>init 3</code> 在 Linux 系统中切换运行级别（也称为运行模式）， 他们的效果是一样的。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> init 3</span><br><span class=line><span class=comment># or</span></span><br><span class=line><span class=built_in>sudo</span> telinit 3</span><br></pre></td></tr></tbody></table></figure><blockquote><p><strong>补课 ^ 啥是运行级别</strong><br>在 Linux 中，运行级别是指操作系统处于不同状态下的配置集合。不同的运行级别可以定义不同的服务和功能。以下是一些常见的运行级别：<br>0 - 关机状态：系统已经关闭或将要关闭。<br>1 - 单用户模式：只有一个用户（通常是 root）可以登录，用于系统维护和修复。<br>2 - 多用户模式，没有网络：多用户模式，但没有网络连接。<br>3 - 多用户模式，有网络：多用户模式，并且启动了网络服务。<br>4 - 保留模式：未分配特定用途，可以根据需要进行自定义配置。<br>5 - 图形用户界面模式：启动图形用户界面（如 X Window System）。<br>6 - 重启状态：用于重新启动系统。</p></blockquote><p>对了，在运行前先看看 nouveau 还运不运行，不输出就是不运行了。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>lsmod | grep nouveau </span><br></pre></td></tr></tbody></table></figure><p>接下来就很简单了，cd 到下载了驱动的目录，先增加可执行权限，然后运行。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line><span class=comment># 给你下载的驱动赋予可执行权限，才可以安装</span></span><br><span class=line><span class=built_in>sudo</span> <span class=built_in>chmod</span> 777 NVIDIA-Linux-x86_64-430.26.run   </span><br><span class=line><span class=comment># 安装 (前面已经安装了openGL，加后缀不安装opengl)</span></span><br><span class=line><span class=built_in>sudo</span> ./NVIDIA-Linux-x86_64-535.86.05.run （–no-opengl-files）   </span><br></pre></td></tr></tbody></table></figure><p>现在，页面大概会变成蓝底白字选项为红色。接下来按照页面的引导继续完成安装即可。而在命令行安装 NVIDIA 显卡驱动时，通常会有一些选项需要你选择。以下是常见的一些选项及其含义：<br><strong>这些选项可能随时间而变化</strong></p><ol><li class=lvl-3><p><strong>Install NVIDIA’s 32-bit compatibility libraries? (YES/NO):</strong></p><ul class=lvl-2><li class=lvl-6>如果你计划运行 32 位的应用程序或库，或者有其他依赖于 32 位库的需求，可以选择 YES。</li><li class=lvl-6>如果不需要支持 32 位应用程序或库，可以选择 NO。</li></ul></li><li class=lvl-3><p><strong>Do you want to run the nvidia-xconfig utility to automatically update your X configuration file so that the NVIDIA X driver will be used when you restart X? (YES/NO):</strong></p><ul class=lvl-2><li class=lvl-6>如果你希望自动更新 X 配置文件，以便在重新启动 X 时使用 NVIDIA 驱动，可以选择 YES。</li><li class=lvl-6>如果你希望手动配置 X 驱动，或者不确定是否需要此功能，可以选择 NO。</li></ul></li><li class=lvl-3><p><strong>Would you like to run the nvidia-persistenced daemon? (YES/NO):</strong></p><ul class=lvl-2><li class=lvl-6><code>nvidia-persistenced</code> 守护程序可以在系统启动时自动加载 NVIDIA 驱动并处理 GPU 的持久性状态。如果你希望启用此功能，可以选择 YES。</li><li class=lvl-6>如果不需要此功能，可以选择 NO。</li></ul></li><li class=lvl-3><p><strong>Would you like to enable support for OpenGL rendering? (YES/NO):</strong></p><ul class=lvl-2><li class=lvl-6>如果你需要支持 OpenGL 渲染，可以选择 YES。</li><li class=lvl-6>如果不需要 OpenGL 渲染支持，可以选择 NO。</li></ul></li><li class=lvl-3><p><strong>Would you like to run the <span class=exturl data-url=aHR0cDovL252aWRpYS1idWctcmVwb3J0LnNo>nvidia-bug-report.sh<i class="fa fa-external-link-alt"></i></span> script to collect data about your system to assist NVIDIA in providing a better driver? (YES/NO):</strong></p><ul class=lvl-2><li class=lvl-6>如果你愿意为 NVIDIA 提供更好的驱动支持，可以选择 YES，这将帮助他们收集系统信息以进行问题排查和优化。</li><li class=lvl-6>如果不希望提供数据，可以选择 NO。</li></ul></li></ol><p>选择好需要的选项后，正常情况下安装应该是成功了，接下来就是重启了。我是 gdm3 显示管理器，所以用以下指令重启显示管理器，然后再用 <code>sudo init 5</code> 回到图形化界面，如果还不行就重启计算机。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line><span class=built_in>sudo</span> service gdm3 restart <span class=comment>#重启gdm3</span></span><br><span class=line><span class=built_in>sudo</span> init 5 <span class=comment>#切换回图形界面</span></span><br><span class=line><span class=built_in>sudo</span> reboot <span class=comment>#重启</span></span><br></pre></td></tr></tbody></table></figure><p>输入 <code>nvidia-smi</code> 和 <code>nvidia-settings</code> 可以出现以下画面即为成功。</p><figure class="highlight bash"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>nvidia-smi </span><br><span class=line>nvidia-settings </span><br></pre></td></tr></tbody></table></figure><p><img data-src=https://cdn.yuuu.org/post-img/7/4.webp alt="" loading=lazy></p><p><img data-src=https://cdn.yuuu.org/post-img/7/5.webp alt="" loading=lazy></p><p>至此，安装终于结束，电脑也用上了英伟达显卡。太不容易了。然而，在要不是不可以在「软件与更新」里面直接安装，我又为何要绕这么多弯路来这么安装呢？😶‍🌫️</p><h2 id=后记>后记</h2><h3 id=可能遇到的错误>可能遇到的错误</h3><ol><li class=lvl-3><p>缺少 GNU 编译器套装。安装 <code>gcc</code> 和 <code>g++</code>，可以试着重复安装。<br><strong>关键字：cc、gcc</strong></p></li><li class=lvl-3><p>Nouveau 影响英伟达驱动安装。它们两个在同一系统会冲突，禁用 Nouveau 驱动即可。<br><strong>关键字：Nouveau、driver</strong></p></li><li class=lvl-3><p>缺少 make 工具。安装 <code>make</code> 即可，可以试着重复安装。<br><strong>关键字：make、tool</strong></p></li></ol><h3 id=遭遇>遭遇</h3><p>本人将这块硬盘装在了 amd 显卡的电脑上，虽然能启动，但是一直在黑屏，无奈之下只好重装了系统。至此，再也不用烦恼英伟达的显卡驱动问题了。</p><h3 id=参考链接>参考链接</h3><p><span class=exturl data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzQ4NTMwNzAxMC9hbnN3ZXIvMzAxNjc2MzAwOQ==">如何安装 NVIDIA 显卡驱动？<i class="fa fa-external-link-alt"></i></span><br><span class=exturl data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BlcmZlY3Q4ODYvYXJ0aWNsZS9kZXRhaWxzLzExOTEwOTM4MA==">Ubuntu18-22.04 安装和干净卸载 nvidia 显卡驱动 —— 超详细、最简单<i class="fa fa-external-link-alt"></i></span><br><span class=exturl data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xMTU3NTg4ODI=">NVIDIA 驱动安装 - 从问题到解决 (Linux/Ubuntu)<i class="fa fa-external-link-alt"></i></span></p></div><footer class=post-footer><div class=post-copyright><ul><li class=post-copyright-author><strong>本文作者：</strong> 水氵冫</li><li class=post-copyright-link><strong>本文链接：</strong> <a href=https://yuuu.org/post/54849.html title="7.ubuntu 显卡安装小记">https://yuuu.org/post/54849.html</a></li><li class=post-copyright-license><strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<span class=exturl data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div><div class=post-tags><a href=/tags/%E6%8A%98%E8%85%BE/ rel=tag><i class="fa fa-tag"></i> 折腾</a></div><div class=post-nav><div class=post-nav-item><a href=/post/39791.html rel=prev title="6. 简单 ubuntu 美化"><i class="fa fa-angle-left"></i> 6. 简单 ubuntu 美化</a></div><div class=post-nav-item><a href=/post/47.html rel=next title="8. 购入产品记录">8. 购入产品记录<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class=comments><div id=twikoo-comments></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; 2023 – <span itemprop=copyrightYear>2025</span><span class=with-love><i class="fa fa-heart"></i></span> <span class=author itemprop=copyrightHolder>水氵冫</span></div><div class=wordcount><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-chart-line"></i></span> <span>站点总字数：</span> <span title=站点总字数>36k</span></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-coffee"></i></span> <span>站点阅读时长 &asymp;</span> <span title=站点阅读时长>2:12</span></span></div><a style=color:#999;border-bottom:none!important ; href="https://icp.gov.moe/?keyword=20242424" target=_blank>萌ICP备20242424号</a></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div class=back-to-top role=button aria-label=返回顶部><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin=anonymous></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script src=/js/bookmark.js></script><script src=/js/pjax.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.24.0/algoliasearch-lite.umd.js integrity="sha256-b2n6oSgG4C1stMT/yc/ChGszs9EY/Mhs6oltEjQbFCQ=" crossorigin=anonymous></script><script src=/js/third-party/search/algolia-search.js></script><script src=/js/third-party/pace.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin=anonymous></script><script class=next-config data-name=quicklink type=application/json>{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://yuuu.org/post/54849.html"}</script><script src=/js/third-party/quicklink.js></script><script class=next-config data-name=twikoo type=application/json>{"enable":true,"visitor":false,"envId":"https://twikoo.yuuu.org","el":"#twikoo-comments"}</script><script>document.addEventListener("page:loaded",(()=>{NexT.utils.loadComments(CONFIG.twikoo.el).then((()=>NexT.utils.getScript(CONFIG.twikoo.jsUrl||"https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js",{condition:window.twikoo}))).then((()=>{twikoo.init(CONFIG.twikoo)}))}))</script><style>.comments,.post-block{overflow:visible}.tk-owo-emotion{display:inline-block}</style><script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.2/anime.min.js></script><script>var canvasEl=document.createElement("canvas");canvasEl.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:9999999",document.body.appendChild(canvasEl);var ctx=canvasEl.getContext("2d"),numberOfParticules=30,pointerX=0,pointerY=0,tap="click",colors=["rgba(255,182,185,.9)","rgba(250,227,217,.9)","rgba(187,222,214,.9)","rgba(138,198,209,.9)"];function setCanvasSize(){canvasEl.width=2*window.innerWidth,canvasEl.height=2*window.innerHeight,canvasEl.style.width=window.innerWidth+"px",canvasEl.style.height=window.innerHeight+"px",canvasEl.getContext("2d").scale(2,2)}function updateCoords(e){pointerX=e.clientX||e.touches&&e.touches[0].clientX,pointerY=e.clientY||e.touches&&e.touches[0].clientY}function setParticuleDirection(e){var a=anime.random(0,360)*Math.PI/180,t=anime.random(50,180),n=[-1,1][anime.random(0,1)]*t;return{x:e.x+n*Math.cos(a),y:e.y+n*Math.sin(a)}}function createParticule(e,a){var t={};return t.x=e,t.y=a,t.color=colors[anime.random(0,colors.length-1)],t.radius=anime.random(16,32),t.endPos=setParticuleDirection(t),t.draw=function(){ctx.beginPath(),ctx.arc(t.x,t.y,t.radius,0,2*Math.PI,!0),ctx.fillStyle=t.color,ctx.fill()},t}function createCircle(e,a){var t={};return t.x=e,t.y=a,t.color="#FFF",t.radius=.1,t.alpha=.5,t.lineWidth=6,t.draw=function(){ctx.globalAlpha=t.alpha,ctx.beginPath(),ctx.arc(t.x,t.y,t.radius,0,2*Math.PI,!0),ctx.lineWidth=t.lineWidth,ctx.strokeStyle=t.color,ctx.stroke(),ctx.globalAlpha=1},t}function renderParticule(e){for(var a=0;a<e.animatables.length;a++)e.animatables[a].target.draw()}function animateParticules(e,a){for(var t=createCircle(e,a),n=[],i=0;i<numberOfParticules;i++)n.push(createParticule(e,a));anime.timeline().add({targets:n,x:function(e){return e.endPos.x},y:function(e){return e.endPos.y},radius:.1,duration:anime.random(1200,1800),easing:"easeOutExpo",update:renderParticule}).add({targets:t,radius:anime.random(80,160),lineWidth:0,alpha:{value:0,easing:"linear",duration:anime.random(600,800)},duration:anime.random(1200,1800),easing:"easeOutExpo",update:renderParticule},0)}var render=anime({duration:1/0,update:function(){ctx.clearRect(0,0,canvasEl.width,canvasEl.height)}});document.addEventListener(tap,(function(e){render.play(),updateCoords(e),animateParticules(pointerX,pointerY)}),!1),setCanvasSize(),window.addEventListener("resize",setCanvasSize,!1)</script><script>document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector("body"),t=document.getElementById("g-pointer-1"),n=document.getElementById("g-pointer-2");let o;if(!t||!n)return void console.error("元素未找到");const i=t.offsetWidth/2,s=n.offsetWidth/2;e.addEventListener("mousemove",(function(e){t.classList.add("pointer-visible"),n.classList.add("pointer-visible"),window.requestAnimationFrame((()=>{var o,r;o=e.clientX,r=e.clientY,t.style.transform=`translate(${o-i}px, ${r-i}px)`,n.style.transform=`translate(${o-s}px, ${r-s}px)`})),clearTimeout(o),o=setTimeout((()=>{t.classList.remove("pointer-visible"),n.classList.remove("pointer-visible")}),1e3)}))}))</script><div id=g-pointer-1></div><div id=g-pointer-2></div><canvas id=map></canvas><script src=https://cdn.jsdelivr.net/gh/lrsjng/pagemap/dist/pagemap.min.js></script><script>pagemap(document.querySelector("#map"),{viewport:null,styles:{"header,footer,section,article":"rgba(0,0,0,0.08)","h1,a":"rgba(0,0,0,0.10)","h2,h3,h4":"rgba(0,0,0,0.08)"},back:"rgba(0,0,0,0.02)",view:"rgba(0,0,0,0.05)",drag:"rgba(0,0,0,0.10)",interval:null})</script><script>document.addEventListener("DOMContentLoaded",(function(){if(/Android|iPhone|iPad|iPod|Windows Phone/i.test(navigator.userAgent)){["g-pointer-1","g-pointer-2"].forEach((e=>{let n=document.getElementById(e);n&&(n.style.display="none")}))}}))</script></body></html>